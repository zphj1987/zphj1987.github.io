<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>rgwè¿½åŠ å†™åŠŸèƒ½æµ‹è¯•éªŒè¯ | ç£¨ç£¨çš„æŠ€æœ¯ç¬”è®°</title><meta name="keywords" content="ceph"><meta name="author" content="zphj1987"><meta name="copyright" content="zphj1987"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="rgwè¿½åŠ å†™åŠŸèƒ½æµ‹è¯•éªŒè¯"><meta name="application-name" content="rgwè¿½åŠ å†™åŠŸèƒ½æµ‹è¯•éªŒè¯"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="rgwè¿½åŠ å†™åŠŸèƒ½æµ‹è¯•éªŒè¯"><meta property="og:url" content="https://zphj1987.com/2024/12/13/rgw%E8%BF%BD%E5%8A%A0%E5%86%99%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E9%AA%8C%E8%AF%81/index.html"><meta property="og:site_name" content="ç£¨ç£¨çš„æŠ€æœ¯ç¬”è®°"><meta property="og:description" content="èƒŒæ™¯awsçš„s3ä»¥å‰æ˜¯ä¸æ”¯æŒè¿½åŠ å†™è¿™ä¸ªåŠŸèƒ½çš„  è¿™ä¸ªå­˜å‚¨ç±»å‹å¤§æ¦‚æ˜¯2023å¹´å‘å¸ƒçš„ï¼Œè¿™ä¸ªæ–‡ç« æ˜¯2024å¹´11æœˆ21æ—¥å‘å¸ƒçš„ æ‰¾åˆ°åŠŸèƒ½çš„å‘å¸ƒå¤§æ¦‚æ—¶é—´æˆ‘ä»¬çœ‹ä¸‹boto3çš„å·¥å…·æ˜¯ä»€ä¹ˆæ—¶å€™é›†æˆè¿›å»çš„å°±çŸ¥é“è¿™ä¸ªåŠŸèƒ½å‘å¸ƒçš„å¤§æ¦‚çš„æ—¶é—´ 1WriteOffsetBytes awsé‡Œé¢ä½¿ç”¨è¿™ä¸ªå‚æ•°å»æ§åˆ¶è¿½åŠ å†™çš„åç§»é‡"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://zphj1987.com/images/blog/s3forheader.png"><meta property="article:author" content="zphj1987"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://zphj1987.com/images/blog/s3forheader.png"><meta name="description" content="èƒŒæ™¯awsçš„s3ä»¥å‰æ˜¯ä¸æ”¯æŒè¿½åŠ å†™è¿™ä¸ªåŠŸèƒ½çš„  è¿™ä¸ªå­˜å‚¨ç±»å‹å¤§æ¦‚æ˜¯2023å¹´å‘å¸ƒçš„ï¼Œè¿™ä¸ªæ–‡ç« æ˜¯2024å¹´11æœˆ21æ—¥å‘å¸ƒçš„ æ‰¾åˆ°åŠŸèƒ½çš„å‘å¸ƒå¤§æ¦‚æ—¶é—´æˆ‘ä»¬çœ‹ä¸‹boto3çš„å·¥å…·æ˜¯ä»€ä¹ˆæ—¶å€™é›†æˆè¿›å»çš„å°±çŸ¥é“è¿™ä¸ªåŠŸèƒ½å‘å¸ƒçš„å¤§æ¦‚çš„æ—¶é—´ 1WriteOffsetBytes awsé‡Œé¢ä½¿ç”¨è¿™ä¸ªå‚æ•°å»æ§åˆ¶è¿½åŠ å†™çš„åç§»é‡"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://zphj1987.com/2024/12/13/rgw%E8%BF%BD%E5%8A%A0%E5%86%99%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E9%AA%8C%E8%AF%81/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?0a806a1271c36ae0e709307eae2a6eb5";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: undefined,
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: false,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: {"appId":"GXWN6XTBBN","apiKey":"46fe2a73adf385608a95fb1cf263e589","indexName":"zphj","hits":{"per_page":6},"languages":{"input_placeholder":"è¾“å…¥å…³é”®è¯åæŒ‰ä¸‹å›è½¦æŸ¥æ‰¾","hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼Œç”¨æ—¶ ${time} æ¯«ç§’"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€","rightMenuMsgToTraditionalChinese":"è½¬ä¸ºç¹ä½“","rightMenuMsgToSimplifiedChinese":"è½¬ä¸ºç®€ä½“"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":330},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"ä½œè€…: zphj1987","link":"é“¾æ¥: ","source":"æ¥æº: ç£¨ç£¨çš„æŠ€æœ¯ç¬”è®°","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚","copySuccess":"å¤åˆ¶æˆåŠŸï¼Œå¤åˆ¶å’Œè½¬è½½è¯·æ ‡æ³¨æœ¬æ–‡åœ°å€"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'ç£¨ç£¨çš„æŠ€æœ¯ç¬”è®°',
  title: 'rgwè¿½åŠ å†™åŠŸèƒ½æµ‹è¯•éªŒè¯',
  postAI: '',
  pageFillDescription: 'èƒŒæ™¯, æ‰¾åˆ°åŠŸèƒ½çš„å‘å¸ƒå¤§æ¦‚æ—¶é—´, cephè¿™è¾¹çš„é€‚é…, åŠŸèƒ½çš„éªŒè¯, ç¡®å®šboto3çš„ä½ç½®, éªŒè¯è¿½åŠ å†™åŠŸèƒ½, awsçš„è¿½åŠ å†™æ–¹æ³•, restapiè¿½åŠ å†™çš„åŠŸèƒ½, æ€»ç»“èƒŒæ™¯çš„ä»¥å‰æ˜¯ä¸æ”¯æŒè¿½åŠ å†™è¿™ä¸ªåŠŸèƒ½çš„è¿™ä¸ªå­˜å‚¨ç±»å‹å¤§æ¦‚æ˜¯å¹´å‘å¸ƒçš„è¿™ä¸ªæ–‡ç« æ˜¯å¹´æœˆæ—¥å‘å¸ƒçš„æ‰¾åˆ°åŠŸèƒ½çš„å‘å¸ƒå¤§æ¦‚æ—¶é—´æˆ‘ä»¬çœ‹ä¸‹çš„å·¥å…·æ˜¯ä»€ä¹ˆæ—¶å€™é›†æˆè¿›å»çš„å°±çŸ¥é“è¿™ä¸ªåŠŸèƒ½å‘å¸ƒçš„å¤§æ¦‚çš„æ—¶é—´é‡Œé¢ä½¿ç”¨è¿™ä¸ªå‚æ•°å»æ§åˆ¶è¿½åŠ å†™çš„åç§»é‡çš„æˆ‘ä»¬æ ¹æ®è¿™ä¸ªå…³é”®å­—å»æ‰¾æ‰¾åˆ°çš„ä»£ç ä½¿ç”¨ä¸‹è½½ä¸‹æ¥è¿›å…¥åˆ°è¿™ä¸ªç›®å½•è¿™ä¸ªç›®å½•é‡Œé¢æ˜¯çš„çš„æ¥å£æ–‡æ¡£ä¹Ÿå°±æ˜¯ä¸ç®¡æ˜¯ç”¨çš„è¿˜æ˜¯ä½¿ç”¨è¿›è¡Œæ“ä½œçš„æ—¶å€™å‘½ä»¤è¡Œçš„ä¸€äº›æ¥å£éƒ½æ˜¯é€šè¿‡è¿™ä¸ªç›®å½•é‡Œé¢çš„æ–‡ä»¶å»åˆ¤æ–­çš„æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶çš„æ‰€æœ‰çš„å†å²æäº¤æ‰¾åˆ°äº†è¿™ä¸ªåœ°æ–¹çš„æäº¤ä»£ç æ‰¾åˆ°è¿™ä¸ªæäº¤å› ä¸ºè¿™ä¸ªæ¨¡å‹çš„æäº¤å¾ˆé¢‘ç¹æ‰€ä»¥è¿™ä¸ªæäº¤é‡Œé¢ä¹Ÿä¸ä¼šå•ç‹¬è¯´æ˜è¿™ä¸ªåŠŸèƒ½æŸ¥çœ‹è¿™æ¬¡æäº¤ç¡®è®¤å°±æ˜¯è¿™ä¸ªæäº¤é‡Œé¢å¢åŠ çš„ä¹Ÿå°±æ˜¯ä¸Šé¢çš„å¹´çš„æœˆæ—¥è·Ÿä¸Šé¢çš„å‘å¸ƒæ—¶é—´åŸºæœ¬å¯¹ä¸Šäº†ä¹Ÿå°±æ˜¯é‚£è¾¹å‘å¸ƒäº†æ¥å£æ–‡æ¡£è¿™è¾¹é€‚é…å‡ ä¸ªå…³é”®å­—å°±å¯ä»¥ä½¿ç”¨ç›¸å…³çš„åŠŸèƒ½äº†è¿™ä¸ªæ¾è€¦åˆåšçš„éå¸¸å¥½è¿™è¾¹çš„é€‚é…æˆ‘ä»¬çœ‹ä¸‹å®˜æ–¹æ–‡æ¡£è¿”å›çš„å…³é”®å­—æ˜¯é‚£æˆ‘ä»¬æŸ¥è¯¢è¿™ä¸ªå…³é”®å­—å°±çŸ¥é“ä»€ä¹ˆæ—¶å€™åˆå…¥çš„è¿™ä¸ªåŠŸèƒ½çš„æœ€å¼€å§‹åœ¨å¹´å°±æå‡ºæ¥äº†è¿™ä¸ªæ˜¯é˜¿é‡Œäº‘çš„æ”¯æŒè¿™ä¸ªåŠŸèƒ½ç„¶åè¿™è¾¹åšäº†é€‚é…è¿™ä¸ªåœ°æ–¹ä»æ—¶é—´çº¿ä¸Šé¢å®˜æ–¹è¿™ä¸ªå‘å¸ƒçš„æ—¶é—´æœ‰ç‚¹æ™šåœ¨å¹´çš„æœˆå°±åˆå…¥äº†è¿™ä¸ªåŠŸèƒ½äº†ä¹Ÿå°±æ˜¯åŸºæœ¬ä¸Šå¹´æœˆåé¢çš„ä¸»å‘è¡Œç‰ˆæœ¬åº”è¯¥éƒ½æ˜¯æ”¯æŒè¿™ä¸ªåŠŸèƒ½çš„åŠŸèƒ½çš„éªŒè¯å®˜æ–¹çš„è¯´æ˜è¿™ä¸ªå†™çš„æ˜¯è¿™ä¸ªç›®å½•ä¸‹é¢æœ‰æ€æ ·ä½¿ç”¨çš„å®¢æˆ·ç«¯å’Œçš„ä¾‹å­ä»¥åŠç›¸å…³çš„çš„æ‰©å±•ä¸€èˆ¬å…¼å®¹æ€§æ¥å£çš„åšæ³•æ˜¯åŸºäºçš„åŸç”Ÿæ ‡å‡†æ¥å£å†åšæ‰©å±•æ“ä½œè¿™ä¸ªé‡Œé¢å°±æ˜¯ç›¸å…³çš„çš„æ–‡ä»¶æˆ‘ä»¬éœ€è¦æŠŠå®˜æ–¹æä¾›çš„æ·»åŠ åˆ°æ­£åœ¨ä½¿ç”¨çš„çš„é‡Œé¢å»å…·ä½“æ“ä½œä¸‹é¢ä¼šå†™ç¡®å®šçš„ä½ç½®è¿™ä¸ªåœ°æ–¹å¾ˆå®¹æ˜“å‡ºé—®é¢˜å› ä¸ºå¯èƒ½ç¯å¢ƒé‡Œé¢è£…äº†ä¸åŒç‰ˆæœ¬çš„å¯èƒ½é‡æ–°å®‰è£…å°±æŒ‰ç…§äº†æ–°çš„ç‰ˆæœ¬ä¹Ÿæœ‰å¯èƒ½é€šè¿‡ä¸åŒçš„å‘½ä»¤å®‰è£…äº†ä¸åŒçš„ç‰ˆæœ¬æˆ‘ä»¬éœ€è¦ç¡®å®šå¥½æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„çš„åº“åœ¨å“ªé‡Œå®‰è£…è¿™é‡Œæˆ‘æŒ‡å®šäº†å®‰è£…çš„ç‰ˆæœ¬å› ä¸ºå¯¹è¿™ä¸ªçš„ç‰ˆæœ¬æœ‰è¦æ±‚ç„¶åéš”ä¸€å¤©é‡æ–°å®‰è£…å°±å‡çº§äº†å¯ä»¥é€šè¿‡ä¸Šé¢çš„å‘½ä»¤æ¥æŒ‰ç…§æŒ‡å®šçš„ç‰ˆæœ¬å³å¯ç¡®å®šè·¯å¾„å¯ä»¥çœ‹åˆ°è·¯å¾„åœ¨æ³¨æ„ä¸‹æˆ‘ä»¬çš„æ¨¡å‹æ˜¯åœ¨è¿™ä¸ªä¸‹é¢çš„é‡Œé¢çš„æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶æ˜¯æ²¡æœ‰ä»€ä¹ˆå†…å®¹çš„æˆ‘ä»¬éœ€è¦æŠŠçš„æ‰©å±•æ”¾åˆ°è¿™ä¸ªé‡Œé¢è¿™ä¸ªå»è‡ªå·±ä½¿ç”¨çš„ç‰ˆæœ¬é‡Œé¢æ‰¾è·¨ç‰ˆæœ¬æœ‰å¯èƒ½å‡ºç°å½“å‰ç‰ˆæœ¬æ²¡æ”¯æŒåé¢ç‰ˆæœ¬æ”¯æŒçš„æƒ…å†µæ‰€ä»¥å°½é‡ä½¿ç”¨å½“å‰ç‰ˆæœ¬æ¯”å¦‚ä¸Šé¢è¿™ä¸ªæ˜¯æˆ‘è¦æµ‹è¯•çš„ç‰ˆæœ¬çš„ä¸‹é¢æ˜¯å½“å‰æœ€æ–°ç‰ˆæœ¬çš„å¯ä»¥çœ‹åˆ°è·¯å¾„å‘ç”Ÿäº†å˜åŒ–æŠŠçš„æ”¾åˆ°ä¸‹é¢å»äº†è¿™ä¸ªæ‰¾ä¸‹å³å¯æ›¿æ¢æ£€æŸ¥ç¡®è®¤ä¸‹ç›¸å…³çš„å…³é”®å­—å·²ç»æ”¾å…¥äº†ä¸Šé¢çš„å°±æ˜¯ç¡®è®¤æœ‰äº†éªŒè¯è¿½åŠ å†™åŠŸèƒ½è¿™ä¸ªæ˜¯å®˜æ–¹æä¾›çš„ä¾‹å­å¯ä»¥çœ‹ä¸‹å¤§æ¦‚çš„å†…å®¹å…ˆåˆ é™¤æŒ‡å®šçš„åç§°çš„å¯¹è±¡ç„¶ååœ¨çš„ä½ç½®å†™å…¥å­—ç¬¦ç„¶ååœ¨è·å–è¿”å›çš„åŸºäºå†™å…¥ä¸‹ä¸€ä¸ªå­—ç¬¦çœ‹ä¸‹çš„å®˜æ–¹çš„ä¾‹å­å¤§éƒ¨åˆ†æ˜¯ä¸€æ ·çš„å°±æ˜¯å¯¹åº”çš„æ˜¯çš„ä¿®æ”¹æˆè‡ªå·±å¯ä»¥ç”¨çš„è„šæœ¬è¿è¡Œè„šæœ¬å‚æ•°æ˜¯ä¸€ä¸ªåä¸€ä¸ªå¯¹è±¡çš„åç§°æŸ¥çœ‹è¿è¡Œçš„æ•ˆæœå¯ä»¥çœ‹åˆ°è¿½åŠ å†™çš„åŠŸèƒ½æˆåŠŸäº†ç¡®å®æœ‰ä¸ªå­—ç¬¦äº†ä¸Šé¢çš„æ˜¯ä½¿ç”¨çš„çš„åšçš„çš„æµ‹è¯•ç”¨ä¾‹çœ‹ä¸‹çš„æ€æ ·ä½¿ç”¨çš„è¿½åŠ å†™æ–¹æ³•è¿™ä¸ªæ˜¯è¿™è¾¹çš„æ¨èçš„æ–¹æ³•è¿™ä¸ªé‡Œé¢æœ‰ä¸ªçš„å…³é”®å­—è¿™ä¸ªå°±æ˜¯å¯¹è±¡çš„åç§»é‡è§„åˆ™æ˜¯æŒ‡å®šåç§°æŒ‡å®šå¯¹è±¡çš„åç§°æŒ‡å®šæœ¬åœ°çš„æ–‡ä»¶è¿™ä¸ªæŒ‡å®šåç§»é‡çš„ä¹Ÿå°±æ˜¯å­˜åœ¨çš„å¯¹è±¡çš„å¤§å°è¿™ä¸ªåœ°æ–¹ä¼šåœ¨å‘½ä»¤è¡Œè¿™è¾¹è§£æä¸ºè§„åˆ™å°±æ˜¯å¤§å†™å­—ç¬¦å’Œå°å†™å­—ç¬¦ä¹‹é—´ä¼šæ’å…¥ä¸€ä¸ªè¿™ä¸ªæ˜¯çš„è¿™è¾¹çš„è§£æåœ¨è¿™è¾¹æ˜¯æŒ‰å’Œæ¥è§£æçš„é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•å‘½ä»¤è¡Œç”¨è¿™ä¸ªå‚æ•°æµ‹è¯•ä¸‹è½½ä¸‹æ¥çœ‹çœ‹å†è¿½åŠ å†ä¸‹è½½å†æµ‹è¯•å¯ä»¥çœ‹åˆ°è¿½åŠ å†™çš„æ—¶å€™å¿…é¡»æ­£ç¡®çš„æŒ‡å®šå·²ç»å­˜åœ¨çš„å¯¹è±¡çš„å¤§å°ä½ç½®ä¹Ÿå°±æ˜¯åç§»é‡ä»å“ªé‡Œå¼€å§‹è¿½åŠ å†™è¿”å›çš„ä½ç½®å°±æ˜¯æœ€åçš„å¯¹è±¡çš„å¤§å°å¯ä»¥çœ‹åˆ°è¿½åŠ å†™æˆåŠŸäº†è¿½åŠ å†™çš„åŠŸèƒ½ä¸‹é¢æ˜¯æ­£å¸¸çš„ä¸Šä¼ çš„ä»£ç ä¸æ˜¯è¿½åŠ å†™çš„åŠŸèƒ½é…ç½®çš„è®¿é—®ä¿¡æ¯çš„åœ°å€è®¡ç®—ç­¾åè°ƒè¯•ä¿¡æ¯ä¸Šä¼ å¯¹è±¡åˆ°è°ƒè¯•ä¿¡æ¯è°ƒè¯•ä¿¡æ¯ä½¿ç”¨ç¤ºä¾‹æˆ‘ä»¬å†æ¥ä¸€ä¸ªè¿½åŠ å†™çš„é…ç½®çš„è®¿é—®ä¿¡æ¯çš„åœ°å€è®¡ç®—ç­¾åè°ƒè¯•ä¿¡æ¯ä¸Šä¼ å¯¹è±¡åˆ°è°ƒè¯•ä¿¡æ¯è°ƒè¯•ä¿¡æ¯ä½¿ç”¨ç¤ºä¾‹å¯ä»¥çœ‹åˆ°ç­¾åçš„åœ°æ–¹å¹¶æ²¡æœ‰æ”¹å˜æ”¹å˜çš„å°±æ˜¯è¯·æ±‚çš„å‘ç”Ÿäº†å˜åŒ–çœ‹ä¸‹è¿è¡Œæ•ˆæœå¯ä»¥çœ‹åˆ°è¿”å›çš„ä¸ºä¹Ÿå°±æ˜¯ä¸‹ä¸ªè¯·æ±‚åº”è¯¥ä»å¼€å§‹æŸ¥çœ‹æ–‡ä»¶å¤§å°å†æ¬¡è¯·æ±‚å†æ¬¡æŸ¥çœ‹å¯ä»¥çœ‹åˆ°æ–‡ä»¶è¿½åŠ å†™è¿›å»äº†ä¸Šé¢çš„ä¾‹å­æ˜¯ç”¨çš„è®¤è¯åšçš„ä¾‹å­è®¤è¯æ¯”è¦ç®€å•ä¸€äº›æ€»ç»“æœ¬ç¯‡ä»‹ç»äº†è¿™è¾¹çš„çš„è¿½åŠ å†™çš„åŠŸèƒ½éªŒè¯å¯ä»¥çœ‹åˆ°è·Ÿç±»ä¼¼å…³é”®å­—åšä¸€ç‚¹æ”¹å˜å³å¯æœ¬ç¯‡ä»ä¸‰ä¸ªå·¥å…·è®²è¿°äº†é‡Œé¢çš„è¿½åŠ å†™çš„åŠŸèƒ½çš„çš„çš„æ–¹æ³•çš„å·¥å…·çš„æ–¹æ³•ä»¥åŠçš„æ–¹æ³•ä»ä¸‰ä¸ªåœ°æ–¹è®²è¿°äº†æ€æ ·å‘èµ·è¿½åŠ å†™çš„è¯·æ±‚æ•´ä½“ä¸Šè¿˜æ˜¯æ¯”è¾ƒç®€å•å°±æ˜¯å¯¹ç€æŒ‡å®šçš„ä½ç½®å‘èµ·è¯·æ±‚å³å¯å°±æ˜¯è¯·æ±‚çš„æ—¶å€™å¸¦ä¸Šä¸€ä¸ªåç§»é‡',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-13 18:12:25',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="ç£¨ç£¨çš„æŠ€æœ¯ç¬”è®°" type="application/atom+xml">
</head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="åŠ è½½å¤´åƒ" src="/images/logo.jpeg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">å…¶å®ƒç«™ç‚¹</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.csdn.net/zphj1987" title="CSDN-æ­¦æ±‰ç£¨ç£¨"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="CSDN-æ­¦æ±‰ç£¨ç£¨"/><span class="back-menu-item-text">CSDN-æ­¦æ±‰ç£¨ç£¨</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">ç£¨ç£¨çš„æŠ€æœ¯ç¬”è®°</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> æ–‡åº“</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> æ–‡ç« åˆ—è¡¨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> å…¨éƒ¨åˆ†ç±»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> å…¨éƒ¨æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/sitemap.xml"><span> sitemap</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> æˆ‘çš„</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> ç›¸å†Œé›†</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> æˆ‘çš„è£…å¤‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> å…³äº</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> é—²è¨€ç¢è¯­</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> éšä¾¿é€›é€›</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> å…³äºæœ¬äºº</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="éšæœºå‰å¾€ä¸€ä¸ªæ–‡ç« " href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="æœç´¢ğŸ”" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> æœç´¢</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="ä¸­æ§å°" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/images/wechatmei.png" target="_blank"><img class="post-qr-code-img" alt="å¾®ä¿¡" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/wechatmei.png"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="/images/zhifubaomei.png" target="_blank"><img class="post-qr-code-img" alt="æ”¯ä»˜å®" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/zhifubaomei.png"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">äº’åŠ¨</div><span class="author-content-item-title"> æœ€æ–°è¯„è®º</span></div><div class="aside-list"><span>æ­£åœ¨åŠ è½½ä¸­...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">å…´è¶£ç‚¹</div><span class="author-content-item-title">å¯»æ‰¾ä½ æ„Ÿå…´è¶£çš„é¢†åŸŸ</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>1</sup></a><a href="/tags/ceph/" style="font-size: 1.05rem;">ceph<sup>15</sup></a><a href="/tags/chatgpt/" style="font-size: 1.05rem;">chatgpt<sup>1</sup></a><a href="/tags/deepseek/" style="font-size: 1.05rem;">deepseek<sup>1</sup></a><a href="/tags/docker/" style="font-size: 1.05rem;">docker<sup>2</sup></a><a href="/tags/exsi/" style="font-size: 1.05rem;">exsi<sup>1</sup></a><a href="/tags/iscsi%E7%9B%B8%E5%85%B3/" style="font-size: 1.05rem;">iscsiç›¸å…³<sup>1</sup></a><a href="/tags/lvm/" style="font-size: 1.05rem;">lvm<sup>1</sup></a><a href="/tags/macos/" style="font-size: 1.05rem;">macos<sup>1</sup></a><a href="/tags/openai/" style="font-size: 1.05rem;">openai<sup>1</sup></a><a href="/tags/samba/" style="font-size: 1.05rem;">samba<sup>1</sup></a><a href="/tags/windows/" style="font-size: 1.05rem;">windows<sup>2</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" style="font-size: 1.05rem;">å†…å­˜ç®¡ç†<sup>1</sup></a><a href="/tags/%E5%86%85%E6%A0%B8/" style="font-size: 1.05rem;">å†…æ ¸<sup>2</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E5%85%B3/" style="font-size: 1.05rem;">åšå®¢ç›¸å…³<sup>1</sup></a><a href="/tags/%E5%AD%98%E5%82%A8/" style="font-size: 1.05rem;">å­˜å‚¨<sup>1</sup></a><a href="/tags/%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3/" style="font-size: 1.05rem;">å­˜å‚¨ç›¸å…³<sup>1</sup></a><a href="/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" style="font-size: 1.05rem;">å¼‚å¸¸å¤„ç†<sup>1</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 1.05rem;">æ“ä½œç³»ç»Ÿ<sup>2</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/" style="font-size: 1.05rem;">æ•°æ®ç®¡ç†<sup>1</sup></a><a href="/tags/%E6%9A%82%E6%9C%AA%E5%88%86%E7%B1%BB/" style="font-size: 1.05rem;">æš‚æœªåˆ†ç±»<sup>302</sup></a><a href="/tags/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" style="font-size: 1.05rem;">æ‚ä¸ƒæ‚å…«<sup>1</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 1.05rem;">æµ‹è¯•<sup>1</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95%E7%9B%B8%E5%85%B3/" style="font-size: 1.05rem;">æµ‹è¯•ç›¸å…³<sup>1</sup></a><a href="/tags/%E7%9B%91%E6%8E%A7/" style="font-size: 1.05rem;">ç›‘æ§<sup>1</sup></a><a href="/tags/%E7%A3%81%E7%9B%98/" style="font-size: 1.05rem;">ç£ç›˜<sup>1</sup></a><a href="/tags/%E7%A3%81%E7%9B%98%E7%9B%B8%E5%85%B3/" style="font-size: 1.05rem;">ç£ç›˜ç›¸å…³<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1/" style="font-size: 1.05rem;">ç³»ç»ŸæœåŠ¡<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/" style="font-size: 1.05rem;">ç³»ç»Ÿé…ç½®<sup>3</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/" style="font-size: 1.05rem;">ç½‘ç»œé…ç½®<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/" style="font-size: 1.05rem;">è™šæ‹ŸåŒ–<sup>2</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" style="font-size: 1.05rem;">è®¡ç®—æœº<sup>1</sup></a><a href="/tags/%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/" style="font-size: 1.05rem;">é—®é¢˜å¤„ç†<sup>1</sup></a><a href="/tags/%E9%AB%98%E5%8F%AF%E7%94%A8/" style="font-size: 1.05rem;">é«˜å¯ç”¨<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>æ–‡ç« </span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>å½’æ¡£</span><a class="card-more-btn" href="/archives/" title="æŸ¥çœ‹æ›´å¤š">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/02/"><span class="card-archive-list-date">äºŒæœˆ 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">åäºŒæœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">10</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">åä¸€æœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">ä¹æœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">å…«æœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">ä¸ƒæœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/06/"><span class="card-archive-list-date">å…­æœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/05/"><span class="card-archive-list-date">äº”æœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>ç¯‡</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="æ˜¾ç¤ºæ¨¡å¼åˆ‡æ¢" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="è¾¹æ æ˜¾ç¤ºæ§åˆ¶"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="åˆ‡æ¢"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">åŸåˆ›</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%98%E5%82%A8%E7%B3%BB%E7%BB%9F/" itemprop="url">å­˜å‚¨ç³»ç»Ÿ</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/ceph/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>ceph</span></a></span></div></div><h1 class="post-title" itemprop="name headline">rgwè¿½åŠ å†™åŠŸèƒ½æµ‹è¯•éªŒè¯</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-12-13T09:24:30.000Z" title="å‘è¡¨äº 2024-12-13 17:24:30">2024-12-13</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-12-13T10:12:25.628Z" title="æ›´æ–°äº 2024-12-13 18:12:25">2024-12-13</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="rgwè¿½åŠ å†™åŠŸèƒ½æµ‹è¯•éªŒè¯"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="é˜…è¯»é‡">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="ä½œè€…IPå±åœ°ä¸ºæ­¦æ±‰"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>æ­¦æ±‰</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/images/blog/s3forheader.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://zphj1987.com/2024/12/13/rgw%E8%BF%BD%E5%8A%A0%E5%86%99%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E9%AA%8C%E8%AF%81/"><header><a class="post-meta-categories" href="/categories/%E5%AD%98%E5%82%A8%E7%B3%BB%E7%BB%9F/" itemprop="url">å­˜å‚¨ç³»ç»Ÿ</a><a href="/tags/ceph/" tabindex="-1" itemprop="url">ceph</a><h1 id="CrawlerTitle" itemprop="name headline">rgwè¿½åŠ å†™åŠŸèƒ½æµ‹è¯•éªŒè¯</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">zphj1987</span><time itemprop="dateCreated datePublished" datetime="2024-12-13T09:24:30.000Z" title="å‘è¡¨äº 2024-12-13 17:24:30">2024-12-13</time><time itemprop="dateCreated datePublished" datetime="2024-12-13T10:12:25.628Z" title="æ›´æ–°äº 2024-12-13 18:12:25">2024-12-13</time></header><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>awsçš„s3ä»¥å‰æ˜¯ä¸æ”¯æŒè¿½åŠ å†™è¿™ä¸ªåŠŸèƒ½çš„</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/Pasted%20image%2020241213100200.png"></p>
<p>è¿™ä¸ªå­˜å‚¨ç±»å‹å¤§æ¦‚æ˜¯2023å¹´å‘å¸ƒçš„ï¼Œè¿™ä¸ªæ–‡ç« æ˜¯2024å¹´11æœˆ21æ—¥å‘å¸ƒçš„</p>
<h3 id="æ‰¾åˆ°åŠŸèƒ½çš„å‘å¸ƒå¤§æ¦‚æ—¶é—´"><a href="#æ‰¾åˆ°åŠŸèƒ½çš„å‘å¸ƒå¤§æ¦‚æ—¶é—´" class="headerlink" title="æ‰¾åˆ°åŠŸèƒ½çš„å‘å¸ƒå¤§æ¦‚æ—¶é—´"></a>æ‰¾åˆ°åŠŸèƒ½çš„å‘å¸ƒå¤§æ¦‚æ—¶é—´</h3><p>æˆ‘ä»¬çœ‹ä¸‹boto3çš„å·¥å…·æ˜¯ä»€ä¹ˆæ—¶å€™é›†æˆè¿›å»çš„å°±çŸ¥é“è¿™ä¸ªåŠŸèƒ½å‘å¸ƒçš„å¤§æ¦‚çš„æ—¶é—´</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WriteOffsetBytes</span><br></pre></td></tr></table></figure>
<p>awsé‡Œé¢ä½¿ç”¨è¿™ä¸ªå‚æ•°å»æ§åˆ¶è¿½åŠ å†™çš„åç§»é‡çš„ï¼Œæˆ‘ä»¬æ ¹æ®è¿™ä¸ªå…³é”®å­—å»æ‰¾</p>
<p>æ‰¾åˆ°botcoreçš„ä»£ç ï¼Œä½¿ç”¨gitä¸‹è½½ä¸‹æ¥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span>  botocore/botocore/data/s3/2006-03-01</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥åˆ°è¿™ä¸ªç›®å½•ï¼Œè¿™ä¸ªç›®å½•é‡Œé¢æ˜¯awsçš„s3çš„æ¥å£æ–‡æ¡£ï¼Œä¹Ÿå°±æ˜¯ä¸ç®¡æ˜¯ç”¨pythonçš„sdkè¿˜æ˜¯ä½¿ç”¨awsè¿›è¡Œæ“ä½œçš„æ—¶å€™ï¼Œå‘½ä»¤è¡Œçš„ä¸€äº›æ¥å£éƒ½æ˜¯é€šè¿‡è¿™ä¸ªç›®å½•é‡Œé¢çš„jsonæ–‡ä»¶å»åˆ¤æ–­çš„</p>
<p>æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶çš„æ‰€æœ‰çš„å†å²æäº¤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> -p service-2.json</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°äº†è¿™ä¸ªåœ°æ–¹çš„æäº¤ä»£ç </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@@ -9579,6 +9667,12 @@</span><br><span class="line">           <span class="string">&quot;location&quot;</span>:<span class="string">&quot;uri&quot;</span>,</span><br><span class="line">           <span class="string">&quot;locationName&quot;</span>:<span class="string">&quot;Key&quot;</span></span><br><span class="line">         &#125;,</span><br><span class="line">+        <span class="string">&quot;WriteOffsetBytes&quot;</span>:&#123;</span><br><span class="line">+          <span class="string">&quot;shape&quot;</span>:<span class="string">&quot;WriteOffsetBytes&quot;</span>,</span><br><span class="line">+          <span class="string">&quot;documentation&quot;</span>:<span class="string">&quot;&lt;p&gt; Specifies the offset for appending data to existing objects in bytes. The offset must be equal to the size of the existing object being appended to. If no object exists, setting this header to 0 will create a new object. &lt;/p&gt; &lt;note&gt; &lt;p&gt;This functionality is only supported for objects in the Amazon S3 Express One Zone storage class in directory buckets.&lt;/p&gt; &lt;/note&gt;&quot;</span>,</span><br><span class="line">+          <span class="string">&quot;location&quot;</span>:<span class="string">&quot;header&quot;</span>,</span><br><span class="line">+          <span class="string">&quot;locationName&quot;</span>:<span class="string">&quot;x-amz-write-offset-bytes&quot;</span></span><br><span class="line">+        &#125;,</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°5c8efd314eee44949f6a9e1fb8af522c654ded15è¿™ä¸ªæäº¤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">commit 5c8efd314eee44949f6a9e1fb8af522c654ded15</span><br><span class="line">Author: aws-sdk-python-automation &lt;github-aws-sdk-python-automation@amazon.com&gt;</span><br><span class="line">Date:   Fri Nov 22 00:52:00 2024 +0000</span><br><span class="line"></span><br><span class="line">    Update to latest models</span><br></pre></td></tr></table></figure>
<p>å› ä¸ºè¿™ä¸ªæ¨¡å‹çš„æäº¤å¾ˆé¢‘ç¹ï¼Œæ‰€ä»¥è¿™ä¸ªæäº¤é‡Œé¢ä¹Ÿä¸ä¼šå•ç‹¬è¯´æ˜è¿™ä¸ªåŠŸèƒ½</p>
<p>æŸ¥çœ‹è¿™æ¬¡æäº¤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git  show 5c8efd314eee44949f6a9e1fb8af522c654ded15  service-2.json</span><br></pre></td></tr></table></figure>

<p>ç¡®è®¤å°±æ˜¯è¿™ä¸ªæäº¤é‡Œé¢å¢åŠ çš„</p>
<p>ä¹Ÿå°±æ˜¯ä¸Šé¢çš„2024å¹´çš„11æœˆ21æ—¥ï¼Œè·Ÿä¸Šé¢çš„å‘å¸ƒæ—¶é—´åŸºæœ¬å¯¹ä¸Šäº†ï¼Œä¹Ÿå°±æ˜¯é‚£è¾¹å‘å¸ƒäº†æ¥å£æ–‡æ¡£ï¼Œè¿™è¾¹é€‚é…å‡ ä¸ªå…³é”®å­—å°±å¯ä»¥ä½¿ç”¨ç›¸å…³çš„åŠŸèƒ½äº†ï¼Œè¿™ä¸ªæ¾è€¦åˆåšçš„éå¸¸å¥½</p>
<h2 id="cephè¿™è¾¹çš„é€‚é…"><a href="#cephè¿™è¾¹çš„é€‚é…" class="headerlink" title="cephè¿™è¾¹çš„é€‚é…"></a>cephè¿™è¾¹çš„é€‚é…</h2><p>æˆ‘ä»¬çœ‹ä¸‹å®˜æ–¹æ–‡æ¡£</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://docs.ceph.com/en/reef/radosgw/s3/objectops/</span><br></pre></td></tr></table></figure>

<p>è¿”å›çš„å…³é”®å­—æ˜¯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x-rgw-next-append-position</span><br></pre></td></tr></table></figure>

<p>é‚£æˆ‘ä»¬æŸ¥è¯¢è¿™ä¸ªå…³é”®å­—å°±çŸ¥é“ä»€ä¹ˆæ—¶å€™åˆå…¥çš„è¿™ä¸ªåŠŸèƒ½çš„</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/Pasted%20image%2020241213103133.png"></p>
<p>æœ€å¼€å§‹åœ¨2018å¹´å°±æå‡ºæ¥äº†ï¼Œè¿™ä¸ªæ˜¯é˜¿é‡Œäº‘çš„ossæ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Œç„¶åcephè¿™è¾¹åšäº†é€‚é…ï¼Œè¿™ä¸ªåœ°æ–¹ä»æ—¶é—´çº¿ä¸Šé¢awså®˜æ–¹è¿™ä¸ªå‘å¸ƒçš„æ—¶é—´æœ‰ç‚¹æ™š</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/Pasted%20image%2020241213103407.png"></p>
<p>åœ¨2019å¹´çš„2æœˆå°±åˆå…¥äº†è¿™ä¸ªåŠŸèƒ½äº†ï¼Œä¹Ÿå°±æ˜¯åŸºæœ¬ä¸Š2019å¹´2æœˆåé¢çš„ä¸»å‘è¡Œç‰ˆæœ¬åº”è¯¥éƒ½æ˜¯æ”¯æŒè¿™ä¸ªåŠŸèƒ½çš„</p>
<h2 id="åŠŸèƒ½çš„éªŒè¯"><a href="#åŠŸèƒ½çš„éªŒè¯" class="headerlink" title="åŠŸèƒ½çš„éªŒè¯"></a>åŠŸèƒ½çš„éªŒè¯</h2><p>å®˜æ–¹çš„è¯´æ˜</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/ceph/ceph/blob/main/examples/rgw/boto3/README.md">https://github.com/ceph/ceph/blob/main/examples/rgw/boto3/README.md</a></p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">This directory contains examples on how to use AWS CLI/boto3 to exercise the RadosGW extensions to the S3 API. This is an extension to theÂ [AWS SDK](https://github.com/boto/botocore/blob/develop/botocore/data/s3/2006-03-01/service-2.json).</span><br><span class="line"></span><br><span class="line">For the standard client to support these extensions, theÂ `service-2.sdk-extras.json`Â file should be added. You can place it under the default folderÂ `~/.aws/models/s3/2006-03-01/`Â or create a custom oneÂ `/path/to/custom/folder/models/s3/2006-03-01/`Â and add it toÂ `AWS_DATA_PATH`Â environment variable. For more information seeÂ [here](https://github.com/boto/botocore/blob/develop/botocore/loaders.py<span class="comment">#L33).</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå†™çš„æ˜¯ï¼Œè¿™ä¸ªç›®å½•ä¸‹é¢æœ‰æ€æ ·ä½¿ç”¨awsçš„å®¢æˆ·ç«¯å’Œboto3çš„ä¾‹å­ï¼Œä»¥åŠç›¸å…³çš„apiçš„æ‰©å±•ï¼Œä¸€èˆ¬å…¼å®¹æ€§s3æ¥å£çš„åšæ³•æ˜¯åŸºäºs3çš„åŸç”Ÿæ ‡å‡†æ¥å£å†åšæ‰©å±•æ“ä½œï¼Œè¿™ä¸ªé‡Œé¢å°±æ˜¯ç›¸å…³çš„apiçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠcephå®˜æ–¹æä¾›çš„service-2.sdk-extras.jsonï¼Œæ·»åŠ åˆ°æ­£åœ¨ä½¿ç”¨çš„boto3çš„sdké‡Œé¢å»ï¼Œå…·ä½“æ“ä½œä¸‹é¢ä¼šå†™</p>
<h2 id="ç¡®å®šboto3çš„ä½ç½®"><a href="#ç¡®å®šboto3çš„ä½ç½®" class="headerlink" title="ç¡®å®šboto3çš„ä½ç½®"></a>ç¡®å®šboto3çš„ä½ç½®</h2><p>è¿™ä¸ªåœ°æ–¹å¾ˆå®¹æ˜“å‡ºé—®é¢˜ï¼Œå› ä¸ºå¯èƒ½ç¯å¢ƒé‡Œé¢è£…äº†ä¸åŒç‰ˆæœ¬çš„boto3ï¼Œå¯èƒ½é‡æ–°å®‰è£…å°±æŒ‰ç…§äº†æ–°çš„ç‰ˆæœ¬ï¼Œä¹Ÿæœ‰å¯èƒ½é€šè¿‡ä¸åŒçš„å‘½ä»¤å®‰è£…äº†ä¸åŒçš„ç‰ˆæœ¬ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šå¥½æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„boto3çš„åº“åœ¨å“ªé‡Œ</p>
<p>å®‰è£…boto3</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 site-packages]<span class="comment"># pip3 install boto3==1.35.79  botocore==1.35.79  -i https://mirrors.aliyun.com/pypi/simple</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæˆ‘æŒ‡å®šäº†å®‰è£…çš„ç‰ˆæœ¬ï¼Œå› ä¸ºawså¯¹è¿™ä¸ªbotocoreçš„ç‰ˆæœ¬æœ‰è¦æ±‚ï¼Œç„¶åéš”ä¸€å¤©botoé‡æ–°å®‰è£…å°±å‡çº§äº†ï¼Œå¯ä»¥é€šè¿‡ä¸Šé¢çš„å‘½ä»¤æ¥æŒ‰ç…§æŒ‡å®šçš„ç‰ˆæœ¬å³å¯</p>
<p>ç¡®å®šè·¯å¾„</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 site-packages]<span class="comment"># python3</span></span><br><span class="line">Python 3.9.6 (default, Dec 12 2024, 16:15:26)</span><br><span class="line">[GCC 4.8.5 20150623 (Red Hat 4.8.5-44)] on linux</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import botocore</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(botocore)</span><br><span class="line">&lt;module <span class="string">&#x27;botocore&#x27;</span> from <span class="string">&#x27;/usr/local/lib/python3.9/site-packages/botocore/__init__.py&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°è·¯å¾„åœ¨</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/lib/python3.9/site-packages/botocore</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ä¸‹æˆ‘ä»¬çš„æ¨¡å‹æ˜¯åœ¨è¿™ä¸ªä¸‹é¢çš„botocoreé‡Œé¢çš„</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 2006-03-01]<span class="comment"># ll /usr/local/lib/python3.9/site-packages/botocore/data/s3/2006-03-01/</span></span><br><span class="line">total 248</span><br><span class="line">-rw-r--r-- 1 root root  18305 Dec 13 10:48 endpoint-rule-set-1.json.gz</span><br><span class="line">-rw-r--r-- 1 root root  57596 Dec 13 10:48 examples-1.json</span><br><span class="line">-rw-r--r-- 1 root root   1837 Dec 13 10:48 paginators-1.json</span><br><span class="line">-rw-r--r-- 1 root root    856 Dec 13 10:48 paginators-1.sdk-extras.json</span><br><span class="line">-rw-r--r-- 1 root root 154059 Dec 13 10:48 service-2.json.gz</span><br><span class="line">-rw-r--r-- 1 root root     98 Dec 13 10:48 service-2.sdk-extras.json</span><br><span class="line">-rw-r--r-- 1 root root   1436 Dec 13 10:48 waiters-2.json</span><br></pre></td></tr></table></figure>
<p>æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 2006-03-01]<span class="comment"># cat /usr/local/lib/python3.9/site-packages/botocore/data/s3/2006-03-01/service-2.sdk-extras.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;version&quot;</span>: 1.0,</span><br><span class="line">  <span class="string">&quot;merge&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;shapes&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;Expires&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;timestamp&quot;</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶æ˜¯æ²¡æœ‰ä»€ä¹ˆå†…å®¹çš„ï¼Œæˆ‘ä»¬éœ€è¦æŠŠcephçš„æ‰©å±•æ”¾åˆ°è¿™ä¸ªé‡Œé¢ </p>
<p>è¿™ä¸ªå»è‡ªå·±ä½¿ç”¨çš„cephç‰ˆæœ¬é‡Œé¢æ‰¾ï¼Œè·¨ç‰ˆæœ¬æœ‰å¯èƒ½å‡ºç°å½“å‰ç‰ˆæœ¬æ²¡æ”¯æŒï¼Œåé¢ç‰ˆæœ¬æ”¯æŒçš„æƒ…å†µï¼Œæ‰€ä»¥å°½é‡ä½¿ç”¨å½“å‰ç‰ˆæœ¬</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/ceph/ceph/blob/v15.2.17/examples/boto3/service-2.sdk-extras.json</span><br></pre></td></tr></table></figure>

<p>æ¯”å¦‚ä¸Šé¢è¿™ä¸ªæ˜¯æˆ‘è¦æµ‹è¯•çš„ç‰ˆæœ¬çš„ï¼Œä¸‹é¢æ˜¯å½“å‰æœ€æ–°ç‰ˆæœ¬çš„</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/ceph/ceph/blob/main/examples/rgw/boto3/service-2.sdk-extras.json</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è·¯å¾„å‘ç”Ÿäº†å˜åŒ–ï¼ŒæŠŠboto3çš„æ”¾åˆ°rgwä¸‹é¢å»äº†ï¼Œè¿™ä¸ªæ‰¾ä¸‹å³å¯</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ~]<span class="comment">#wget  https://raw.githubusercontent.com/ceph/ceph/refs/heads/main/examples/rgw/boto3/service-2.sdk-extras.json</span></span><br><span class="line">[root@lab101 ~]<span class="comment"># cp service-2.sdk-extras.json /usr/local/lib/python3.9/site-packages/botocore/data/s3/2006-03-01/service-2.sdk-extras.json</span></span><br><span class="line"><span class="built_in">cp</span>: overwrite â€˜/usr/local/lib/python3.9/site-packages/botocore/data/s3/2006-03-01/service-2.sdk-extras.jsonâ€™? y</span><br></pre></td></tr></table></figure>

<p>æ›¿æ¢</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 2006-03-01]<span class="comment"># cat service-2.sdk-extras.json |grep Append</span></span><br><span class="line">                <span class="string">&quot;AppendPosition&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;shape&quot;</span>:<span class="string">&quot;AppendPosition&quot;</span>,</span><br><span class="line">                <span class="string">&quot;Append&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;shape&quot;</span>:<span class="string">&quot;Append&quot;</span>,</span><br><span class="line">                    <span class="string">&quot;documentation&quot;</span>:<span class="string">&quot;&lt;p&gt;Append Object&lt;/p&gt;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Append&quot;</span>: &#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;boolean&quot;</span>&#125;,</span><br><span class="line">        <span class="string">&quot;AppendPosition&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;integer&quot;</span>&#125;,</span><br><span class="line">                <span class="string">&quot;AppendPosition&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;shape&quot;</span>:<span class="string">&quot;AppendPosition&quot;</span>,</span><br></pre></td></tr></table></figure>
<p>æ£€æŸ¥ç¡®è®¤ä¸‹ç›¸å…³çš„å…³é”®å­—å·²ç»æ”¾å…¥äº†ï¼Œä¸Šé¢çš„å°±æ˜¯ç¡®è®¤æœ‰äº†</p>
<h3 id="éªŒè¯è¿½åŠ å†™åŠŸèƒ½"><a href="#éªŒè¯è¿½åŠ å†™åŠŸèƒ½" class="headerlink" title="éªŒè¯è¿½åŠ å†™åŠŸèƒ½"></a>éªŒè¯è¿½åŠ å†™åŠŸèƒ½</h3><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/ceph/ceph/blob/v15.2.17/examples/boto3/append_object.py">https://github.com/ceph/ceph/blob/v15.2.17/examples/boto3/append_object.py</a></p>
</blockquote>
<p>è¿™ä¸ªæ˜¯cephå®˜æ–¹æä¾›çš„ä¾‹å­</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/python</span></span><br><span class="line">from __future__ import print_function</span><br><span class="line"></span><br><span class="line">import boto3</span><br><span class="line">import sys</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">def js_print(arg):</span><br><span class="line">    <span class="built_in">print</span>(json.dumps(arg, indent=2))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) != 3:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Usage: &#x27;</span> + sys.argv[0] + <span class="string">&#x27; &lt;bucket&gt; &lt;key&gt;&#x27;</span>)</span><br><span class="line">    sys.exit(1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># bucket name as first argument</span></span><br><span class="line">bucketname = sys.argv[1]</span><br><span class="line">keyname = sys.argv[2]</span><br><span class="line"><span class="comment"># endpoint and keys from vstart</span></span><br><span class="line">endpoint = <span class="string">&#x27;http://127.0.0.1:8000&#x27;</span></span><br><span class="line">access_key=<span class="string">&#x27;0555b35654ad1656d804&#x27;</span></span><br><span class="line">secret_key=<span class="string">&#x27;h7GhxuBLTrlhVUyxSPUKUV8r/2EI4ngqJxD7iBdBYLhwluN30JaT3Q==&#x27;</span></span><br><span class="line"></span><br><span class="line">client = boto3.client(<span class="string">&#x27;s3&#x27;</span>,</span><br><span class="line">        endpoint_url=endpoint,</span><br><span class="line">        aws_access_key_id=access_key,</span><br><span class="line">        aws_secret_access_key=secret_key)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;deleting object first&#x27;</span>)</span><br><span class="line">js_print(client.delete_object(Bucket=bucketname, Key=keyname))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;appending at position 0&#x27;</span>)</span><br><span class="line">resp = client.put_object(Bucket=bucketname, Key=keyname,</span><br><span class="line">                         Append=True,</span><br><span class="line">                         AppendPosition=0,</span><br><span class="line">                         Body=<span class="string">&#x27;8letters&#x27;</span>)</span><br><span class="line"></span><br><span class="line">js_print(resp)</span><br><span class="line">append_pos = resp[<span class="string">&#x27;AppendPosition&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;appending at position %d&#x27;</span> % append_pos)</span><br><span class="line">js_print(client.put_object(Bucket=bucketname, Key=keyname,</span><br><span class="line">                           Append=True,</span><br><span class="line">                           AppendPosition=append_pos,</span><br><span class="line">                           Body=<span class="string">&#x27;8letters&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹ä¸‹å¤§æ¦‚çš„å†…å®¹</p>
<ul>
<li>å…ˆåˆ é™¤æŒ‡å®šçš„åç§°çš„å¯¹è±¡</li>
<li>ç„¶ååœ¨0çš„ä½ç½®å†™å…¥8letterså­—ç¬¦</li>
<li>ç„¶ååœ¨è·å–è¿”å›çš„AppendPosition</li>
<li>åŸºäºAppendPositionå†™å…¥ä¸‹ä¸€ä¸ª8letterså­—ç¬¦</li>
</ul>
<p>çœ‹ä¸‹awsçš„å®˜æ–¹çš„ä¾‹å­</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s3.put_object(Bucket=<span class="string">&#x27;amzn-s3-demo-bucket--use2-az2--x-s3&#x27;</span>, Key=<span class="string">&#x27;2024-11-05-sdk-test&#x27;</span>, Body=b<span class="string">&#x27;123456789&#x27;</span>, WriteOffsetBytes=9)</span><br></pre></td></tr></table></figure>
<p>å¤§éƒ¨åˆ†æ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯WriteOffsetByteså¯¹åº”çš„æ˜¯cephçš„AppendPosition</p>
<p>ä¿®æ”¹æˆè‡ªå·±å¯ä»¥ç”¨çš„è„šæœ¬</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ceph]<span class="comment"># cat test.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line">from __future__ import print_function</span><br><span class="line"></span><br><span class="line">import boto3</span><br><span class="line">import sys</span><br><span class="line">import json</span><br><span class="line"></span><br><span class="line">def js_print(arg):</span><br><span class="line">    <span class="built_in">print</span>(json.dumps(arg, indent=2))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> len(sys.argv) != 3:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Usage: &#x27;</span> + sys.argv[0] + <span class="string">&#x27; &lt;bucket&gt; &lt;key&gt;&#x27;</span>)</span><br><span class="line">    sys.exit(1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># bucket name as first argument</span></span><br><span class="line">bucketname = sys.argv[1]</span><br><span class="line">keyname = sys.argv[2]</span><br><span class="line"><span class="comment"># endpoint and keys from vstart</span></span><br><span class="line">endpoint = <span class="string">&#x27;http://192.168.0.101:7481&#x27;</span></span><br><span class="line">access_key=<span class="string">&#x27;test1&#x27;</span></span><br><span class="line">secret_key=<span class="string">&#x27;test1&#x27;</span></span><br><span class="line"></span><br><span class="line">client = boto3.client(<span class="string">&#x27;s3&#x27;</span>,</span><br><span class="line">        endpoint_url=endpoint,</span><br><span class="line">        aws_access_key_id=access_key,</span><br><span class="line">        aws_secret_access_key=secret_key)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;deleting object first&#x27;</span>)</span><br><span class="line">js_print(client.delete_object(Bucket=bucketname, Key=keyname))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;appending at position 0&#x27;</span>)</span><br><span class="line">resp = client.put_object(Bucket=bucketname, Key=keyname,</span><br><span class="line">                         Append=True,</span><br><span class="line">                         AppendPosition=0,</span><br><span class="line">                         Body=<span class="string">&#x27;8letters&#x27;</span>)</span><br><span class="line"></span><br><span class="line">js_print(resp)</span><br><span class="line">append_pos = resp[<span class="string">&#x27;AppendPosition&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;appending at position %d&#x27;</span> % append_pos)</span><br><span class="line">js_print(client.put_object(Bucket=bucketname, Key=keyname,</span><br><span class="line">                           Append=True,</span><br><span class="line">                           AppendPosition=append_pos,</span><br><span class="line">                           Body=<span class="string">&#x27;8letters&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œè„šæœ¬</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ceph]<span class="comment"># python3 test.py testbucket myappend.txt</span></span><br><span class="line">deleting object first</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;ResponseMetadata&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;RequestId&quot;</span>: <span class="string">&quot;tx000001eb3924743c3404f-00675ba47a-37bd-default&quot;</span>,</span><br><span class="line">    <span class="string">&quot;HostId&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;HTTPStatusCode&quot;</span>: 204,</span><br><span class="line">    <span class="string">&quot;HTTPHeaders&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;x-amz-request-id&quot;</span>: <span class="string">&quot;tx000001eb3924743c3404f-00675ba47a-37bd-default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;date&quot;</span>: <span class="string">&quot;Fri, 13 Dec 2024 03:05:30 GMT&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;RetryAttempts&quot;</span>: 0</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">appending at position 0</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;ResponseMetadata&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;RequestId&quot;</span>: <span class="string">&quot;tx00000952a1aea29f3ea2f-00675ba47a-37bd-default&quot;</span>,</span><br><span class="line">    <span class="string">&quot;HostId&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;HTTPStatusCode&quot;</span>: 200,</span><br><span class="line">    <span class="string">&quot;HTTPHeaders&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;content-length&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;etag&quot;</span>: <span class="string">&quot;\&quot;4310bc7480e027b4b5aede530e4ee9df\&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;accept-ranges&quot;</span>: <span class="string">&quot;bytes&quot;</span>,</span><br><span class="line">      <span class="string">&quot;x-rgw-next-append-position&quot;</span>: <span class="string">&quot;8&quot;</span>,</span><br><span class="line">      <span class="string">&quot;x-amz-request-id&quot;</span>: <span class="string">&quot;tx00000952a1aea29f3ea2f-00675ba47a-37bd-default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;date&quot;</span>: <span class="string">&quot;Fri, 13 Dec 2024 03:05:30 GMT&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;RetryAttempts&quot;</span>: 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;ETag&quot;</span>: <span class="string">&quot;\&quot;4310bc7480e027b4b5aede530e4ee9df\&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AppendPosition&quot;</span>: 8</span><br><span class="line">&#125;</span><br><span class="line">appending at position 8</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;ResponseMetadata&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;RequestId&quot;</span>: <span class="string">&quot;tx00000bb44851eb1f0253d-00675ba47a-37bd-default&quot;</span>,</span><br><span class="line">    <span class="string">&quot;HostId&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;HTTPStatusCode&quot;</span>: 200,</span><br><span class="line">    <span class="string">&quot;HTTPHeaders&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;content-length&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">      <span class="string">&quot;etag&quot;</span>: <span class="string">&quot;\&quot;4310bc7480e027b4b5aede530e4ee9df\&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;accept-ranges&quot;</span>: <span class="string">&quot;bytes&quot;</span>,</span><br><span class="line">      <span class="string">&quot;x-rgw-next-append-position&quot;</span>: <span class="string">&quot;16&quot;</span>,</span><br><span class="line">      <span class="string">&quot;x-amz-request-id&quot;</span>: <span class="string">&quot;tx00000bb44851eb1f0253d-00675ba47a-37bd-default&quot;</span>,</span><br><span class="line">      <span class="string">&quot;date&quot;</span>: <span class="string">&quot;Fri, 13 Dec 2024 03:05:30 GMT&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;RetryAttempts&quot;</span>: 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;ETag&quot;</span>: <span class="string">&quot;\&quot;4310bc7480e027b4b5aede530e4ee9df\&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AppendPosition&quot;</span>: 16</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‚æ•°æ˜¯ä¸€ä¸ªbucketåï¼Œä¸€ä¸ªå¯¹è±¡çš„åç§°</p>
<p>æŸ¥çœ‹è¿è¡Œçš„æ•ˆæœ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ceph]<span class="comment"># aws --endpoint=http://192.168.0.101:7481 s3 cp  s3://testbucket/myappend.txt  myappend.txt</span></span><br><span class="line">download: s3://testbucket/myappend.txt to ./myappend.txt</span><br><span class="line">[root@lab101 ceph]<span class="comment"># cat myappend.txt</span></span><br><span class="line">8letters8letters[root@lab101 ceph]<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿½åŠ å†™çš„åŠŸèƒ½æˆåŠŸäº†,ç¡®å®æœ‰16ä¸ªå­—ç¬¦äº†</p>
<p>ä¸Šé¢çš„æ˜¯ä½¿ç”¨çš„boto3çš„sdkåšçš„pythonçš„æµ‹è¯•ç”¨ä¾‹ï¼Œçœ‹ä¸‹awsçš„æ€æ ·ä½¿ç”¨</p>
<h2 id="awsçš„è¿½åŠ å†™æ–¹æ³•"><a href="#awsçš„è¿½åŠ å†™æ–¹æ³•" class="headerlink" title="awsçš„è¿½åŠ å†™æ–¹æ³•"></a>awsçš„è¿½åŠ å†™æ–¹æ³•</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://docs.aws.amazon.com/AmazonS3/latest/userguide/directory-buckets-objects-append.html</span><br></pre></td></tr></table></figure>


<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aws s3api put-object --bucket amzn-s3-demo-bucket--azid--x-s3 --key sampleinput/file001.bin --body bucket-seed/file001.bin --write-offset-bytes size-of-sampleinput/file001.bin</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ˜¯awsè¿™è¾¹çš„æ¨èçš„æ–¹æ³•ï¼Œè¿™ä¸ªé‡Œé¢æœ‰ä¸ªwrite-offset-bytesçš„å…³é”®å­—ï¼Œè¿™ä¸ªå°±æ˜¯å¯¹è±¡çš„åç§»é‡<br>è§„åˆ™æ˜¯ï¼š<br>æŒ‡å®šbucketåç§° keyæŒ‡å®šå¯¹è±¡çš„åç§° bodyæŒ‡å®šæœ¬åœ°çš„æ–‡ä»¶ write-offset-bytes è¿™ä¸ªæŒ‡å®šåç§»é‡çš„ï¼Œä¹Ÿå°±æ˜¯å­˜åœ¨çš„å¯¹è±¡çš„å¤§å°</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 2006-03-01]<span class="comment"># cat service-2.json |grep WriteOffsetBytes</span></span><br><span class="line">        <span class="string">&quot;WriteOffsetBytes&quot;</span>:&#123;</span><br><span class="line">          <span class="string">&quot;shape&quot;</span>:<span class="string">&quot;WriteOffsetBytes&quot;</span>,</span><br><span class="line">    <span class="string">&quot;WriteOffsetBytes&quot;</span>:&#123;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªåœ°æ–¹WriteOffsetBytesä¼šåœ¨å‘½ä»¤è¡Œè¿™è¾¹è§£æä¸º â€“write-offset-bytes<br>è§„åˆ™å°±æ˜¯å¤§å†™å­—ç¬¦å’Œå°å†™å­—ç¬¦ä¹‹é—´ä¼šæ’å…¥ä¸€ä¸ª-</p>
<p>è¿™ä¸ªæ˜¯awsçš„è¿™è¾¹çš„è§£æï¼Œåœ¨cephè¿™è¾¹æ˜¯æŒ‰AppendPositionå’ŒAppendæ¥è§£æçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è¯•å‘½ä»¤è¡Œç”¨è¿™ä¸ªå‚æ•°æµ‹è¯•</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ~]<span class="comment"># cat zpappend.txt</span></span><br><span class="line">aaaaaaa</span><br><span class="line">[root@lab101 ~]<span class="comment"># aws    s3api put-object   --endpoint=http://192.168.0.101:7481   --bucket testbucket --key newappend.txt --body zpappend.txt --append   --append-position 0</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;ETag&quot;</span>: <span class="string">&quot;\&quot;15fe514867dd5b4a1abf91ea35ff9e22\&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;AppendPosition&quot;</span>: 8</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‹è½½ä¸‹æ¥çœ‹çœ‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ceph]<span class="comment"># aws --endpoint=http://192.168.0.101:7481 s3 cp s3://testbucket/newappend.txt newappend.txt</span></span><br><span class="line">download: s3://testbucket/newappend.txt to ./newappend.txt</span><br><span class="line">[root@lab101 ceph]<span class="comment"># cat newappend.txt</span></span><br><span class="line">aaaaaaa</span><br></pre></td></tr></table></figure>

<p>å†è¿½åŠ </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ~]<span class="comment"># aws    s3api put-object   --endpoint=http://192.168.0.101:7481   --bucket testbucket --key newappend.txt --body zpappend.txt --append   --append-position 8</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;ETag&quot;</span>: <span class="string">&quot;\&quot;15fe514867dd5b4a1abf91ea35ff9e22\&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;AppendPosition&quot;</span>: 16</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å†ä¸‹è½½</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ceph]<span class="comment"># aws --endpoint=http://192.168.0.101:7481 s3 cp s3://testbucket/newappend.txt newappend.txt</span></span><br><span class="line">download: s3://testbucket/newappend.txt to ./newappend.txt</span><br><span class="line">[root@lab101 ceph]<span class="comment"># cat newappend.txt</span></span><br><span class="line">aaaaaaa</span><br><span class="line">aaaaaaa</span><br></pre></td></tr></table></figure>

<p>å†æµ‹è¯•</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ~]<span class="comment"># aws    s3api put-object   --endpoint=http://192.168.0.101:7481   --bucket testbucket --key newappend.txt --body zpappend.txt --append   --append-position 8</span></span><br><span class="line"></span><br><span class="line">An error occurred (PositionNotEqualToLength) when calling the PutObject operation: Unknown</span><br><span class="line">[root@lab101 ~]<span class="comment"># aws    s3api put-object   --endpoint=http://192.168.0.101:7481   --bucket testbucket --key newappend.txt --body zpappend.txt --append   --append-position 16</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;ETag&quot;</span>: <span class="string">&quot;\&quot;15fe514867dd5b4a1abf91ea35ff9e22\&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;AppendPosition&quot;</span>: 24</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿½åŠ å†™çš„æ—¶å€™å¿…é¡»æ­£ç¡®çš„æŒ‡å®šå·²ç»å­˜åœ¨çš„å¯¹è±¡çš„å¤§å°ä½ç½®ï¼Œä¹Ÿå°±æ˜¯åç§»é‡ï¼Œä»å“ªé‡Œå¼€å§‹è¿½åŠ å†™</p>
<p>è¿”å›çš„ä½ç½®å°±æ˜¯æœ€åçš„å¯¹è±¡çš„å¤§å°</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ceph]<span class="comment"># aws --endpoint=http://192.168.0.101:7481 s3 ls s3://testbucket/newappend.txt</span></span><br><span class="line">2024-12-13 11:22:10         24 newappend.txt</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿½åŠ å†™æˆåŠŸäº†</p>
<h2 id="restapiè¿½åŠ å†™çš„åŠŸèƒ½"><a href="#restapiè¿½åŠ å†™çš„åŠŸèƒ½" class="headerlink" title="restapiè¿½åŠ å†™çš„åŠŸèƒ½"></a>restapiè¿½åŠ å†™çš„åŠŸèƒ½</h2><p>ä¸‹é¢æ˜¯æ­£å¸¸çš„ä¸Šä¼ çš„ä»£ç ï¼Œä¸æ˜¯è¿½åŠ å†™çš„åŠŸèƒ½</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ceph]<span class="comment"># cat test1.py</span></span><br><span class="line"><span class="comment">#! /usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">import requests</span><br><span class="line">import hashlib</span><br><span class="line">import hmac</span><br><span class="line">import datetime</span><br><span class="line">import <span class="built_in">base64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½® Ceph RGW çš„è®¿é—®ä¿¡æ¯</span></span><br><span class="line">ACCESS_KEY = <span class="string">&quot;test1&quot;</span></span><br><span class="line">SECRET_KEY = <span class="string">&quot;test1&quot;</span></span><br><span class="line">RGW_ENDPOINT = <span class="string">&quot;http://192.168.0.101:7481&quot;</span>  <span class="comment"># Ceph RADOS Gateway çš„åœ°å€</span></span><br><span class="line">BUCKET_NAME = <span class="string">&quot;testbucket&quot;</span></span><br><span class="line">OBJECT_KEY = <span class="string">&quot;testrest.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®— AWS S3 ç­¾å</span></span><br><span class="line">def generate_signature(method, bucket, object_key, content_type, <span class="built_in">date</span>, secret_key):</span><br><span class="line">    string_to_sign = f<span class="string">&quot;&#123;method&#125;\n\n&#123;content_type&#125;\n&#123;date&#125;\n/&#123;bucket&#125;/&#123;object_key&#125;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;String to sign:&quot;</span>, string_to_sign)  <span class="comment"># è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">    signature = hmac.new(secret_key.encode(<span class="string">&#x27;utf-8&#x27;</span>), string_to_sign.encode(<span class="string">&#x27;utf-8&#x27;</span>), hashlib.sha1).digest()</span><br><span class="line">    <span class="built_in">return</span> base64.b64encode(signature).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ å¯¹è±¡åˆ° Ceph</span></span><br><span class="line">def upload_object(file_path):</span><br><span class="line">    with open(file_path, <span class="string">&quot;rb&quot;</span>) as f:</span><br><span class="line">        file_data = f.read()</span><br><span class="line"></span><br><span class="line">    content_type = <span class="string">&quot;application/octet-stream&quot;</span></span><br><span class="line">    <span class="built_in">date</span> = datetime.datetime.utcnow().strftime(<span class="string">&quot;%a, %d %b %Y %H:%M:%S GMT&quot;</span>)</span><br><span class="line"></span><br><span class="line">    signature = generate_signature(</span><br><span class="line">        method=<span class="string">&quot;PUT&quot;</span>,</span><br><span class="line">        bucket=BUCKET_NAME,</span><br><span class="line">        object_key=OBJECT_KEY,</span><br><span class="line">        content_type=content_type,</span><br><span class="line">        <span class="built_in">date</span>=<span class="built_in">date</span>,</span><br><span class="line">        secret_key=SECRET_KEY</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: content_type,</span><br><span class="line">        <span class="string">&quot;Date&quot;</span>: <span class="built_in">date</span>,</span><br><span class="line">        <span class="string">&quot;Authorization&quot;</span>: f<span class="string">&quot;AWS &#123;ACCESS_KEY&#125;:&#123;signature&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    url = f<span class="string">&quot;&#123;RGW_ENDPOINT&#125;/&#123;BUCKET_NAME&#125;/&#123;OBJECT_KEY&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Request URL:&quot;</span>, url)  <span class="comment"># è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Headers:&quot;</span>, headers)  <span class="comment"># è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">    response = requests.put(url, headers=headers, data=file_data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> response.status_code == 200:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Upload successful!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(f<span class="string">&quot;Upload failed! Status code: &#123;response.status_code&#125;, Response: &#123;response.text&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    upload_object(<span class="string">&quot;zp.txt&quot;</span>)</span><br></pre></td></tr></table></figure>


<p>æˆ‘ä»¬å†æ¥ä¸€ä¸ªè¿½åŠ å†™çš„restapi</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ceph]<span class="comment"># cat test4.py</span></span><br><span class="line"><span class="comment">#! /usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line">import requests</span><br><span class="line">import hashlib</span><br><span class="line">import hmac</span><br><span class="line">import datetime</span><br><span class="line">import <span class="built_in">base64</span></span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½® Ceph RGW çš„è®¿é—®ä¿¡æ¯</span></span><br><span class="line">ACCESS_KEY = <span class="string">&quot;test1&quot;</span></span><br><span class="line">SECRET_KEY = <span class="string">&quot;test1&quot;</span></span><br><span class="line">RGW_ENDPOINT = <span class="string">&quot;http://192.168.0.101:7481&quot;</span>  <span class="comment"># Ceph RADOS Gateway çš„åœ°å€</span></span><br><span class="line">BUCKET_NAME = <span class="string">&quot;testbucket&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®— AWS S3 ç­¾å</span></span><br><span class="line">def generate_signature(method, bucket, object_key, content_type, <span class="built_in">date</span>, secret_key):</span><br><span class="line">    string_to_sign = f<span class="string">&quot;&#123;method&#125;\n\n&#123;content_type&#125;\n&#123;date&#125;\n/&#123;bucket&#125;/&#123;object_key&#125;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;String to sign:&quot;</span>, string_to_sign)  <span class="comment"># è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">    signature = hmac.new(secret_key.encode(<span class="string">&#x27;utf-8&#x27;</span>), string_to_sign.encode(<span class="string">&#x27;utf-8&#x27;</span>), hashlib.sha1).digest()</span><br><span class="line">    <span class="built_in">return</span> base64.b64encode(signature).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ å¯¹è±¡åˆ° Ceph</span></span><br><span class="line">def upload_object(object_key, file_path, position):</span><br><span class="line">    with open(file_path, <span class="string">&quot;rb&quot;</span>) as f:</span><br><span class="line">        file_data = f.read()</span><br><span class="line"></span><br><span class="line">    content_type = <span class="string">&quot;application/octet-stream&quot;</span></span><br><span class="line">    <span class="built_in">date</span> = datetime.datetime.utcnow().strftime(<span class="string">&quot;%a, %d %b %Y %H:%M:%S GMT&quot;</span>)</span><br><span class="line"></span><br><span class="line">    signature = generate_signature(</span><br><span class="line">        method=<span class="string">&quot;PUT&quot;</span>,</span><br><span class="line">        bucket=BUCKET_NAME,</span><br><span class="line">        object_key=object_key,</span><br><span class="line">        content_type=content_type,</span><br><span class="line">        <span class="built_in">date</span>=<span class="built_in">date</span>,</span><br><span class="line">        secret_key=SECRET_KEY</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Content-Type&quot;</span>: content_type,</span><br><span class="line">        <span class="string">&quot;Date&quot;</span>: <span class="built_in">date</span>,</span><br><span class="line">        <span class="string">&quot;Authorization&quot;</span>: f<span class="string">&quot;AWS &#123;ACCESS_KEY&#125;:&#123;signature&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    url = f<span class="string">&quot;&#123;RGW_ENDPOINT&#125;/&#123;BUCKET_NAME&#125;/&#123;object_key&#125;?position=&#123;position&#125;&amp;append=true&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Request URL:&quot;</span>, url)  <span class="comment"># è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Headers:&quot;</span>, headers)  <span class="comment"># è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line"></span><br><span class="line">    response = requests.put(url, headers=headers, data=file_data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> response.status_code == 200:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Append successful!&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Response headers:&quot;</span>, response.headers)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(f<span class="string">&quot;Append failed! Status code: &#123;response.status_code&#125;, Response: &#123;response.text&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) != 4:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Usage: python3 test4.py &lt;object_key&gt; &lt;file_path&gt; &lt;position&gt;&quot;</span>)</span><br><span class="line">        sys.exit(1)</span><br><span class="line"></span><br><span class="line">    object_key = sys.argv[1]</span><br><span class="line">    file_path = sys.argv[2]</span><br><span class="line">    position = sys.argv[3]</span><br><span class="line"></span><br><span class="line">    upload_object(object_key, file_path, position)</span><br></pre></td></tr></table></figure>


<p>å¯ä»¥çœ‹åˆ°ç­¾åçš„åœ°æ–¹å¹¶æ²¡æœ‰æ”¹å˜ï¼Œæ”¹å˜çš„å°±æ˜¯è¯·æ±‚çš„questsringå‘ç”Ÿäº†å˜åŒ–</p>
<p>çœ‹ä¸‹è¿è¡Œæ•ˆæœ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ceph]<span class="comment"># python3 test4.py  restaaa zp.txt 0</span></span><br><span class="line">String to sign: PUT</span><br><span class="line"></span><br><span class="line">application/octet-stream</span><br><span class="line">Fri, 13 Dec 2024 07:13:33 GMT</span><br><span class="line">/testbucket/restaaa</span><br><span class="line">Request URL: http://192.168.0.101:7481/testbucket/restaaa?position=0&amp;append=<span class="literal">true</span></span><br><span class="line">Headers: &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/octet-stream&#x27;</span>, <span class="string">&#x27;Date&#x27;</span>: <span class="string">&#x27;Fri, 13 Dec 2024 07:13:33 GMT&#x27;</span>, <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">&#x27;AWS test1:3J3okCbKD2WVsNpfngjMPqBmvVU=&#x27;</span>&#125;</span><br><span class="line">Append successful!</span><br><span class="line">Response headers: &#123;<span class="string">&#x27;Content-Length&#x27;</span>: <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;ETag&#x27;</span>: <span class="string">&#x27;&quot;0a2806dcc91865a811d19150084f6de7&quot;&#x27;</span>, <span class="string">&#x27;Accept-Ranges&#x27;</span>: <span class="string">&#x27;bytes&#x27;</span>, <span class="string">&#x27;x-rgw-next-append-position&#x27;</span>: <span class="string">&#x27;16&#x27;</span>, <span class="string">&#x27;x-amz-request-id&#x27;</span>: <span class="string">&#x27;tx00000ec3108225d59c5e1-00675bde9d-37bd-default&#x27;</span>, <span class="string">&#x27;Date&#x27;</span>: <span class="string">&#x27;Fri, 13 Dec 2024 07:13:33 GMT&#x27;</span>, <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;Keep-Alive&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿”å›çš„x-rgw-next-append-positionä¸º16ï¼Œä¹Ÿå°±æ˜¯ä¸‹ä¸ªè¯·æ±‚åº”è¯¥ä»16å¼€å§‹</p>
<p>æŸ¥çœ‹æ–‡ä»¶å¤§å°</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 site-packages]<span class="comment"># aws --endpoint=http://192.168.0.101:7481 s3 ls s3://testbucket/restaaa</span></span><br><span class="line">2024-12-13 15:13:33         16 restaaa</span><br></pre></td></tr></table></figure>

<p>å†æ¬¡è¯·æ±‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 ceph]<span class="comment"># python3 test4.py  restaaa zp.txt 16</span></span><br><span class="line">String to sign: PUT</span><br><span class="line"></span><br><span class="line">application/octet-stream</span><br><span class="line">Fri, 13 Dec 2024 07:14:29 GMT</span><br><span class="line">/testbucket/restaaa</span><br><span class="line">Request URL: http://192.168.0.101:7481/testbucket/restaaa?position=16&amp;append=<span class="literal">true</span></span><br><span class="line">Headers: &#123;<span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/octet-stream&#x27;</span>, <span class="string">&#x27;Date&#x27;</span>: <span class="string">&#x27;Fri, 13 Dec 2024 07:14:29 GMT&#x27;</span>, <span class="string">&#x27;Authorization&#x27;</span>: <span class="string">&#x27;AWS test1:PsYEAg3YnDb8PVBvRWSKL7nPhy0=&#x27;</span>&#125;</span><br><span class="line">Append successful!</span><br><span class="line">Response headers: &#123;<span class="string">&#x27;Content-Length&#x27;</span>: <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;ETag&#x27;</span>: <span class="string">&#x27;&quot;0a2806dcc91865a811d19150084f6de7&quot;&#x27;</span>, <span class="string">&#x27;Accept-Ranges&#x27;</span>: <span class="string">&#x27;bytes&#x27;</span>, <span class="string">&#x27;x-rgw-next-append-position&#x27;</span>: <span class="string">&#x27;32&#x27;</span>, <span class="string">&#x27;x-amz-request-id&#x27;</span>: <span class="string">&#x27;tx00000cbe7cf038ff40327-00675bded5-37bd-default&#x27;</span>, <span class="string">&#x27;Date&#x27;</span>: <span class="string">&#x27;Fri, 13 Dec 2024 07:14:29 GMT&#x27;</span>, <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;Keep-Alive&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>å†æ¬¡æŸ¥çœ‹</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@lab101 site-packages]<span class="comment"># aws --endpoint=http://192.168.0.101:7481 s3 ls s3://testbucket/restaaa</span></span><br><span class="line">2024-12-13 15:14:29         32 restaaa</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°æ–‡ä»¶è¿½åŠ å†™è¿›å»äº† </p>
<p>ä¸Šé¢çš„ä¾‹å­æ˜¯ç”¨çš„v2è®¤è¯åšçš„ä¾‹å­ï¼Œv2è®¤è¯æ¯”v4è¦ç®€å•ä¸€äº›</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬ç¯‡ä»‹ç»äº†cephè¿™è¾¹çš„rgwçš„è¿½åŠ å†™çš„åŠŸèƒ½éªŒè¯ï¼Œå¯ä»¥çœ‹åˆ°è·Ÿawsç±»ä¼¼ï¼Œå…³é”®å­—åšä¸€ç‚¹æ”¹å˜å³å¯ï¼Œæœ¬ç¯‡ä»ä¸‰ä¸ªå·¥å…·è®²è¿°äº†cephé‡Œé¢çš„è¿½åŠ å†™çš„åŠŸèƒ½ï¼ŒPythonçš„botoçš„sdkçš„æ–¹æ³•ï¼Œawsçš„å·¥å…·çš„æ–¹æ³•ï¼Œä»¥åŠrestapiçš„æ–¹æ³•ï¼Œä»ä¸‰ä¸ªåœ°æ–¹è®²è¿°äº†æ€æ ·å‘èµ·è¿½åŠ å†™çš„è¯·æ±‚ï¼Œæ•´ä½“ä¸Šè¿˜æ˜¯æ¯”è¾ƒç®€å•å°±æ˜¯å¯¹ç€æŒ‡å®šçš„ä½ç½®å‘èµ·è¯·æ±‚å³å¯ï¼Œå°±æ˜¯è¯·æ±‚çš„æ—¶å€™å¸¦ä¸Šä¸€ä¸ªåç§»é‡</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="å¤´åƒ"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/logo.jpeg" title="å¤´åƒ" alt="å¤´åƒ"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/logo.jpeg" title="å¤´åƒ" alt="å¤´åƒ"></a><div class="post-copyright__author_name">zphj1987</div><div class="post-copyright__author_desc">ä½†è¡Œå¥½äº‹ï¼Œè«é—®å‰ç¨‹</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="è¯¥æ–‡ç« ä¸ºåŸåˆ›æ–‡ç« ï¼Œæ³¨æ„ç‰ˆæƒåè®®" href="https://zphj1987.com/2024/12/13/rgw%E8%BF%BD%E5%8A%A0%E5%86%99%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E9%AA%8C%E8%AF%81/">åŸåˆ›</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://zphj1987.com/2024/12/13/rgw%E8%BF%BD%E5%8A%A0%E5%86%99%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E9%AA%8C%E8%AF%81/')">rgwè¿½åŠ å†™åŠŸèƒ½æµ‹è¯•éªŒè¯</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="èµèµä½œè€…"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>æ‰“èµä½œè€…</div><div class="reward-main"><div class="reward-all"><span class="reward-title">æ„Ÿè°¢ä½ èµäºˆæˆ‘å‰è¿›çš„åŠ›é‡</span><ul class="reward-group"><li class="reward-item"><a href="/images/wechatmei.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/wechatmei.png" alt="å¾®ä¿¡"/></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="/images/zhifubaomei.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/zhifubaomei.png" alt="æ”¯ä»˜å®"/></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">èµèµè€…åå•</div><div class="reward-dec">å› ä¸ºä½ ä»¬çš„æ”¯æŒè®©æˆ‘æ„è¯†åˆ°å†™æ–‡ç« çš„ä»·å€¼ğŸ™</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« "><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://zphj1987.com/2024/12/13/rgw%E8%BF%BD%E5%8A%A0%E5%86%99%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E9%AA%8C%E8%AF%81/"></div><div class="reward-dec">ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« </div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=rgwè¿½åŠ å†™åŠŸèƒ½æµ‹è¯•éªŒè¯&amp;url=https://zphj1987.com/2024/12/13/rgw%E8%BF%BD%E5%8A%A0%E5%86%99%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95%E9%AA%8C%E8%AF%81/&amp;pic=/images/blog/s3forheader.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="å¤åˆ¶é“¾æ¥" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://zphj1987.com" target="_blank">ç£¨ç£¨çš„æŠ€æœ¯ç¬”è®°</a>ï¼</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/ceph/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>ceph<span class="tagsPageCount">15</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="/images/blog/vdbenchtest.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/12/11/%E7%BA%A0%E5%88%A0%E7%A0%81%E4%B8%AD%E9%97%B4%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E4%B8%A2%E5%A4%B1%E5%BC%95%E8%B5%B7osd%E7%9A%84%E5%B4%A9%E6%BA%83/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/crashstorage.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">çº åˆ ç ä¸­é—´å¯¹è±¡å±æ€§ä¸¢å¤±å¼•èµ·osdçš„å´©æºƒ</div></div></a></div><div class="next-post pull-right"><a href="/2024/12/16/esxi%E5%85%8B%E9%9A%86%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%96%B9%E6%B3%95/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/z.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">esxiå…‹éš†è™šæ‹Ÿæœºæ–¹æ³•</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>å–œæ¬¢è¿™ç¯‡æ–‡ç« çš„äººä¹Ÿçœ‹äº†</span></div><div class="relatedPosts-list"><div><a href="/2024/04/30/ceph-mon%E5%8D%A1%E6%AD%BB%E6%95%85%E9%9A%9C%E5%88%86%E6%9E%90%E5%A4%84%E7%90%86/" title="ceph-monå¡æ­»æ•…éšœåˆ†æå¤„ç†"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/monhung.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-04-30</div><div class="title">ceph-monå¡æ­»æ•…éšœåˆ†æå¤„ç†</div></div></a></div><div><a href="/2024/09/05/ceph-radosgw%E9%85%8D%E7%BD%AEbucket%E7%9A%84policy/" title="ceph-radosgwé…ç½®bucketçš„policy"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/policyimage.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-09-05</div><div class="title">ceph-radosgwé…ç½®bucketçš„policy</div></div></a></div><div><a href="/2024/11/07/cephfs%E7%BB%9F%E8%AE%A1%E7%A8%80%E7%96%8F%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E7%9A%84%E8%84%9A%E6%9C%AC/" title="cephfsç»Ÿè®¡ç¨€ç–æ–‡ä»¶å¤§å°çš„è„šæœ¬"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/filesize.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-11-07</div><div class="title">cephfsç»Ÿè®¡ç¨€ç–æ–‡ä»¶å¤§å°çš„è„šæœ¬</div></div></a></div><div><a href="/2024/11/21/device-health-metrics%E6%AD%A3%E7%A1%AE%E7%9A%84%E5%88%A0%E9%99%A4%E6%96%B9%E6%B3%95/" title="device_health_metricsæ­£ç¡®çš„åˆ é™¤æ–¹æ³•"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/deletepool.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-11-21</div><div class="title">device_health_metricsæ­£ç¡®çš„åˆ é™¤æ–¹æ³•</div></div></a></div><div><a href="/2024/06/26/rbd%E5%81%9A%E5%BF%AB%E7%85%A7%E5%85%8B%E9%9A%86%E4%BB%A5%E5%90%8E%E7%9A%84%E5%AE%B9%E9%87%8F%E7%9B%B8%E5%85%B3%E9%97%AE%E9%A2%98/" title="rbdåšå¿«ç…§å…‹éš†ä»¥åçš„å®¹é‡ç›¸å…³é—®é¢˜"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/clone.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-06-26</div><div class="title">rbdåšå¿«ç…§å…‹éš†ä»¥åçš„å®¹é‡ç›¸å…³é—®é¢˜</div></div></a></div><div><a href="/2023/01/31/s3%E7%9A%84v2%E8%AE%A4%E8%AF%81%E6%9E%84%E9%80%A0-lua/" title="s3çš„v2è®¤è¯æ„é€ -lua"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/default_cover_1.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-01-31</div><div class="title">s3çš„v2è®¤è¯æ„é€ -lua</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> è¯„è®º</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">åŒ¿åè¯„è®º</a><a href="/privacy" style="margin-left: 4px">éšç§æ”¿ç­–</a></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/logo.jpeg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">è¿™æœ‰å…³äº<b style="color:#fff">äº§å“ã€æŠ€æœ¯ã€å¼€å‘</b>ç›¸å…³çš„é—®é¢˜å’Œçœ‹æ³•</b>ã€‚</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">ç›¸ä¿¡ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å¯¹ä½ æœ‰ç”¨çš„<b style="color:#fff">çŸ¥è¯†</b>å’Œ<b style="color:#fff">æ•™ç¨‹</b>ã€‚</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">zphj1987</h1><div class="author-info__desc">ä½†è¡Œå¥½äº‹ï¼Œè«é—®å‰ç¨‹</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/zphj1987" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>æ–‡ç« ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%83%8C%E6%99%AF"><span class="toc-number">1.</span> <span class="toc-text">èƒŒæ™¯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E5%8A%9F%E8%83%BD%E7%9A%84%E5%8F%91%E5%B8%83%E5%A4%A7%E6%A6%82%E6%97%B6%E9%97%B4"><span class="toc-number">1.1.</span> <span class="toc-text">æ‰¾åˆ°åŠŸèƒ½çš„å‘å¸ƒå¤§æ¦‚æ—¶é—´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ceph%E8%BF%99%E8%BE%B9%E7%9A%84%E9%80%82%E9%85%8D"><span class="toc-number">2.</span> <span class="toc-text">cephè¿™è¾¹çš„é€‚é…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E7%9A%84%E9%AA%8C%E8%AF%81"><span class="toc-number">3.</span> <span class="toc-text">åŠŸèƒ½çš„éªŒè¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A1%AE%E5%AE%9Aboto3%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="toc-number">4.</span> <span class="toc-text">ç¡®å®šboto3çš„ä½ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E8%BF%BD%E5%8A%A0%E5%86%99%E5%8A%9F%E8%83%BD"><span class="toc-number">4.1.</span> <span class="toc-text">éªŒè¯è¿½åŠ å†™åŠŸèƒ½</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#aws%E7%9A%84%E8%BF%BD%E5%8A%A0%E5%86%99%E6%96%B9%E6%B3%95"><span class="toc-number">5.</span> <span class="toc-text">awsçš„è¿½åŠ å†™æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#restapi%E8%BF%BD%E5%8A%A0%E5%86%99%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">6.</span> <span class="toc-text">restapiè¿½åŠ å†™çš„åŠŸèƒ½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>æœ€è¿‘å‘å¸ƒ</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/02/12/vdbench%E6%B5%8B%E8%AF%95%E8%BF%87%E7%A8%8B%E5%8F%AF%E8%A7%86%E5%8C%96/" title="vdbenchæµ‹è¯•è¿‡ç¨‹å¯è§†åŒ–"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/vdbenchtest.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="vdbenchæµ‹è¯•è¿‡ç¨‹å¯è§†åŒ–"/></a><div class="content"><a class="title" href="/2025/02/12/vdbench%E6%B5%8B%E8%AF%95%E8%BF%87%E7%A8%8B%E5%8F%AF%E8%A7%86%E5%8C%96/" title="vdbenchæµ‹è¯•è¿‡ç¨‹å¯è§†åŒ–">vdbenchæµ‹è¯•è¿‡ç¨‹å¯è§†åŒ–</a><time datetime="2025-02-12T09:28:31.000Z" title="å‘è¡¨äº 2025-02-12 17:28:31">2025-02-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/08/%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%9C%AC%E5%9C%B0%E7%9A%84deepseek%E7%8E%AF%E5%A2%83/" title="æ­å»ºä¸€ä¸ªæœ¬åœ°çš„deepseekç¯å¢ƒ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/deepseek.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ­å»ºä¸€ä¸ªæœ¬åœ°çš„deepseekç¯å¢ƒ"/></a><div class="content"><a class="title" href="/2025/02/08/%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%9C%AC%E5%9C%B0%E7%9A%84deepseek%E7%8E%AF%E5%A2%83/" title="æ­å»ºä¸€ä¸ªæœ¬åœ°çš„deepseekç¯å¢ƒ">æ­å»ºä¸€ä¸ªæœ¬åœ°çš„deepseekç¯å¢ƒ</a><time datetime="2025-02-08T02:46:38.000Z" title="å‘è¡¨äº 2025-02-08 10:46:38">2025-02-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/31/%E5%B0%8F%E7%94%B5%E8%A7%86%E5%B1%8F%E5%B9%95%E6%8B%89%E4%BC%B8%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/" title="å°ç”µè§†å±å¹•æ‹‰ä¼¸é—®é¢˜è§£å†³"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/20241231145712.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å°ç”µè§†å±å¹•æ‹‰ä¼¸é—®é¢˜è§£å†³"/></a><div class="content"><a class="title" href="/2024/12/31/%E5%B0%8F%E7%94%B5%E8%A7%86%E5%B1%8F%E5%B9%95%E6%8B%89%E4%BC%B8%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/" title="å°ç”µè§†å±å¹•æ‹‰ä¼¸é—®é¢˜è§£å†³">å°ç”µè§†å±å¹•æ‹‰ä¼¸é—®é¢˜è§£å†³</a><time datetime="2024-12-31T06:59:35.000Z" title="å‘è¡¨äº 2024-12-31 14:59:35">2024-12-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/20/%E6%B8%85%E7%90%86macos%E4%B8%8B%E7%9A%84citrix%E6%AE%8B%E7%95%99/" title="æ¸…ç†macosä¸‹çš„citrixæ®‹ç•™"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/z.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ¸…ç†macosä¸‹çš„citrixæ®‹ç•™"/></a><div class="content"><a class="title" href="/2024/12/20/%E6%B8%85%E7%90%86macos%E4%B8%8B%E7%9A%84citrix%E6%AE%8B%E7%95%99/" title="æ¸…ç†macosä¸‹çš„citrixæ®‹ç•™">æ¸…ç†macosä¸‹çš„citrixæ®‹ç•™</a><time datetime="2024-12-20T08:25:42.000Z" title="å‘è¡¨äº 2024-12-20 16:25:42">2024-12-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/20/tgt%E7%9A%84chap%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81%E8%AE%A4%E8%AF%81%E9%80%BB%E8%BE%91/" title="tgtçš„chapåŒå‘è®¤è¯è®¤è¯é€»è¾‘"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/blog/z.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="tgtçš„chapåŒå‘è®¤è¯è®¤è¯é€»è¾‘"/></a><div class="content"><a class="title" href="/2024/12/20/tgt%E7%9A%84chap%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81%E8%AE%A4%E8%AF%81%E9%80%BB%E8%BE%91/" title="tgtçš„chapåŒå‘è®¤è¯è®¤è¯é€»è¾‘">tgtçš„chapåŒå‘è®¤è¯è®¤è¯é€»è¾‘</a><time datetime="2024-12-20T06:51:33.000Z" title="å‘è¡¨äº 2024-12-20 14:51:33">2024-12-20</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/shangban.svg" alt="è·ç¦»æœˆå…¥25kä¹Ÿå°±è¿˜å·®ä¸€ä¸ªå¤§ä½¬å¸¦æˆ‘~" title="è·ç¦»æœˆå…¥25kä¹Ÿå°±è¿˜å·®ä¸€ä¸ªå¤§ä½¬å¸¦æˆ‘~"/><div id="runtimeTextTip"></div></div></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2015 - 2025 By <a class="footer-bar-link" href="/" title="zphj1987" target="_blank">zphj1987</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/" title="é„‚ICPå¤‡2022001754å·-2">é„‚ICPå¤‡2022001754å·-2</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">æ–‡ç« </div><div class="length-num">384</div></a><a href="/tags/" title="tag"><div class="headline">æ ‡ç­¾</div><div class="length-num">34</div></a><a href="/categories/" title="category"><div class="headline">åˆ†ç±»</div><div class="length-num">21</div></a></div><span class="sidebar-menu-item-title">åŠŸèƒ½</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="æ˜¾ç¤ºæ¨¡å¼"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>æ˜¾ç¤ºæ¨¡å¼</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">å…¶å®ƒç«™ç‚¹</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.csdn.net/zphj1987" title="CSDN-æ­¦æ±‰ç£¨ç£¨"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="CSDN-æ­¦æ±‰ç£¨ç£¨"/><span class="back-menu-item-text">CSDN-æ­¦æ±‰ç£¨ç£¨</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> æ–‡åº“</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> æ–‡ç« åˆ—è¡¨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> å…¨éƒ¨åˆ†ç±»</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> å…¨éƒ¨æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/sitemap.xml"><span> sitemap</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> æˆ‘çš„</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> ç›¸å†Œé›†</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/equipment/"><i class="anzhiyufont anzhiyu-icon-dice-d20 faa-tada" style="font-size: 0.9em;"></i><span> æˆ‘çš„è£…å¤‡</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> å…³äº</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/essay/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> é—²è¨€ç¢è¯­</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> éšä¾¿é€›é€›</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> å…³äºæœ¬äºº</span></a></li></ul></div></div><span class="sidebar-menu-item-title">æ ‡ç­¾</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Linux/" style="font-size: 0.88rem;">Linux<sup>1</sup></a><a href="/tags/ceph/" style="font-size: 0.88rem;">ceph<sup>15</sup></a><a href="/tags/chatgpt/" style="font-size: 0.88rem;">chatgpt<sup>1</sup></a><a href="/tags/deepseek/" style="font-size: 0.88rem;">deepseek<sup>1</sup></a><a href="/tags/docker/" style="font-size: 0.88rem;">docker<sup>2</sup></a><a href="/tags/exsi/" style="font-size: 0.88rem;">exsi<sup>1</sup></a><a href="/tags/iscsi%E7%9B%B8%E5%85%B3/" style="font-size: 0.88rem;">iscsiç›¸å…³<sup>1</sup></a><a href="/tags/lvm/" style="font-size: 0.88rem;">lvm<sup>1</sup></a><a href="/tags/macos/" style="font-size: 0.88rem;">macos<sup>1</sup></a><a href="/tags/openai/" style="font-size: 0.88rem;">openai<sup>1</sup></a><a href="/tags/samba/" style="font-size: 0.88rem;">samba<sup>1</sup></a><a href="/tags/windows/" style="font-size: 0.88rem;">windows<sup>2</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/" style="font-size: 0.88rem;">å†…å­˜ç®¡ç†<sup>1</sup></a><a href="/tags/%E5%86%85%E6%A0%B8/" style="font-size: 0.88rem;">å†…æ ¸<sup>2</sup></a><a href="/tags/%E5%8D%9A%E5%AE%A2%E7%9B%B8%E5%85%B3/" style="font-size: 0.88rem;">åšå®¢ç›¸å…³<sup>1</sup></a><a href="/tags/%E5%AD%98%E5%82%A8/" style="font-size: 0.88rem;">å­˜å‚¨<sup>1</sup></a><a href="/tags/%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3/" style="font-size: 0.88rem;">å­˜å‚¨ç›¸å…³<sup>1</sup></a><a href="/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/" style="font-size: 0.88rem;">å¼‚å¸¸å¤„ç†<sup>1</sup></a><a href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 0.88rem;">æ“ä½œç³»ç»Ÿ<sup>2</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/" style="font-size: 0.88rem;">æ•°æ®ç®¡ç†<sup>1</sup></a><a href="/tags/%E6%9A%82%E6%9C%AA%E5%88%86%E7%B1%BB/" style="font-size: 0.88rem;">æš‚æœªåˆ†ç±»<sup>302</sup></a><a href="/tags/%E6%9D%82%E4%B8%83%E6%9D%82%E5%85%AB/" style="font-size: 0.88rem;">æ‚ä¸ƒæ‚å…«<sup>1</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 0.88rem;">æµ‹è¯•<sup>1</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95%E7%9B%B8%E5%85%B3/" style="font-size: 0.88rem;">æµ‹è¯•ç›¸å…³<sup>1</sup></a><a href="/tags/%E7%9B%91%E6%8E%A7/" style="font-size: 0.88rem;">ç›‘æ§<sup>1</sup></a><a href="/tags/%E7%A3%81%E7%9B%98/" style="font-size: 0.88rem;">ç£ç›˜<sup>1</sup></a><a href="/tags/%E7%A3%81%E7%9B%98%E7%9B%B8%E5%85%B3/" style="font-size: 0.88rem;">ç£ç›˜ç›¸å…³<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E6%9C%8D%E5%8A%A1/" style="font-size: 0.88rem;">ç³»ç»ŸæœåŠ¡<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E9%85%8D%E7%BD%AE/" style="font-size: 0.88rem;">ç³»ç»Ÿé…ç½®<sup>3</sup></a><a href="/tags/%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/" style="font-size: 0.88rem;">ç½‘ç»œé…ç½®<sup>1</sup></a><a href="/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/" style="font-size: 0.88rem;">è™šæ‹ŸåŒ–<sup>2</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" style="font-size: 0.88rem;">è®¡ç®—æœº<sup>1</sup></a><a href="/tags/%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/" style="font-size: 0.88rem;">é—®é¢˜å¤„ç†<sup>1</sup></a><a href="/tags/%E9%AB%98%E5%8F%AF%E7%94%A8/" style="font-size: 0.88rem;">é«˜å¯ç”¨<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶é€‰ä¸­æ–‡æœ¬</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>ç²˜è´´æ–‡æœ¬</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>å¼•ç”¨åˆ°è¯„è®º</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>å¤åˆ¶é“¾æ¥åœ°å€</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>å¤åˆ¶æ­¤å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>ä¸‹è½½æ­¤å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>æ–°çª—å£æ‰“å¼€å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>ç«™å†…æœç´¢</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>ç™¾åº¦æœç´¢</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>æ’­æ”¾éŸ³ä¹</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>åˆ‡æ¢åˆ°ä¸Šä¸€é¦–</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>åˆ‡æ¢åˆ°ä¸‹ä¸€é¦–</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>æŸ¥çœ‹æ‰€æœ‰æ­Œæ›²</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶æ­Œå</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>éšä¾¿é€›é€›</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>åšå®¢åˆ†ç±»</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>æ–‡ç« æ ‡ç­¾</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶åœ°å€</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">å…³é—­çƒ­è¯„</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">æ·±è‰²æ¨¡å¼</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>è½‰ç‚ºç¹é«”</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("03/19/2015 12:00:00"); //è®¾ç½®ç½‘ç«™ä¸Šçº¿æ—¶é—´
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // è®¡ç®—å¹¶æ›´æ–°å¤©æ•°ã€å°æ—¶æ•°ã€åˆ†é’Ÿæ•°å’Œç§’æ•°
  function updateTime() {
    now = new Date(); // æ›´æ–° now çš„å€¼
    nowHour = now.getHours(); // æ›´æ–° nowHour çš„å€¼
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // æ›´æ–°ç½‘é¡µä¸­æ˜¾ç¤ºçš„ç½‘ç«™è¿è¡Œæ—¶é—´
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // å¦‚æœæ˜¯ä¸Šç­æ—¶é—´ï¼Œé»˜è®¤å°±æ˜¯"å®‰çŸ¥é±¼-ä¸Šç­æ‘¸é±¼ä¸­.svg"å›¾ç‰‡ï¼Œä¸éœ€è¦æ›´æ”¹
      currentTimeHtml = `æœ¬ç«™å±…ç„¶è¿è¡Œäº† ${dnum} å¤©<span id='runtime'> ${hnum} å°æ—¶ ${mnum} åˆ† ${snum} ç§’ </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // å¦‚æœæ˜¯ä¸‹ç­æ—¶é—´ï¼Œæ’å…¥"å®‰çŸ¥é±¼-ä¸‹ç­å•¦.svg"å›¾ç‰‡
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "/images/xiaban.svg";
        img.title = "ä¸‹ç­äº†å°±è¯¥å¼€å¼€å¿ƒå¿ƒçš„ç©è€ï¼Œå˜¿å˜¿~";
        img.alt = "ä¸‹ç­äº†å°±è¯¥å¼€å¼€å¿ƒå¿ƒçš„ç©è€ï¼Œå˜¿å˜¿~";
      }

      currentTimeHtml = `æœ¬ç«™å±…ç„¶è¿è¡Œäº† ${dnum} å¤©<span id='runtime'> ${hnum} å°æ—¶ ${mnum} åˆ† ${snum} ç§’ </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.60.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(()=>{
  const getGiscusTheme = theme => {
    return theme === 'dark' ? 'dark' : 'light'
  }

  const loadGiscus = () => {
    const config = Object.assign({
      src: 'https://giscus.app/client.js',
      'data-repo': 'zphj1987/zphj1987.github.io',
      'data-repo-id': 'R_kgDOIV6zlA',
      'data-category-id': 'DIC_kwDOIV6zlM4Cg8XC',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true
    },{"data-lang":"zh-CN","data-mapping":"pathname","data-category":"Announcements","data-input-position":"bottom"})

    const ele = document.createElement('script')
    for (let key in config) {
      ele.setAttribute(key, config[key])
    }
    document.getElementById('giscus-wrap').appendChild(ele)
  }

  const changeGiscusTheme = theme => {
    const sendMessage = message => {
      const iframe = document.querySelector('iframe.giscus-frame')
      if (!iframe) return
      iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app')
    }

    sendMessage({
      setConfig: {
        theme: getGiscusTheme(theme)
      }
    });
  }

  anzhiyu.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if ('Giscus' === 'Giscus' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">é€šçŸ¥</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">ä½ å¥½å‘€</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>