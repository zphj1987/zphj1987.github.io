# 锁
- 采用OpenVMS方式的分布式锁管理器
- 所有客户端的缓存一致性
- 元数据服务器使用inode位锁进行文件查找、状态(修改、打开r/w/x)、EAs和布局
- - 客户端可以在单个RPC中为一个inode获取多个位锁
- - MDS管理所有的inode修改，以避免锁资源争用
- 对象存储服务器为OST对象提供基于区段的锁
- - 为每个OST管理文件数据锁
- - 客户端可以被授予部分或全部文件的读范围锁，允许同一文件的多个并发读取器
- - 可以为客户端授予文件区域的非重叠写范围锁
- - 多个Lustre客户端可以同时访问一个文件进行读写，避免了文件I/O过程中的瓶颈

Lustre实现了字节粒度文件和细粒度元数据锁定。多个客户端可以同时读取和修改相同的文件或目录。Lustre分布式锁管理器(LDLM)确保文件系统中所有客户机和服务器之间的文件是一致的。MDT LDLM管理inode权限和路径名上的锁。每个OST都有自己的用于存储在其上的文件条带上的锁的LDLM，它会随着文件系统的增长而扩展锁定性能。

LDLM还在解决客户机故障方面发挥作用。Lustre文件系统中的客户端故障恢复是基于锁撤销和其他资源的，因此幸存的客户端可以不受干扰地继续工作。如果客户端无法响应来自分布式锁管理器(Distributed lock Manager, DLM)的阻塞锁回调，或者长时间无法与服务器通信(例如，没有ping)，客户端将被强制从集群中移除(驱逐)。这使其他客户端能够获得被死客户端锁阻塞的锁，并且释放与该客户端关联的资源(文件句柄、导出数据)。
